<html>
<head>
<title>firstworks   Programming with SQL Relay using the ADO.NET API</title>
<link href="../css/styles.css" rel="stylesheet">
</head>
<body>

<span class="heading1">Programming with SQL Relay using the ADO.NET API</span><br><br>

<ul>
<li><a href="#languages">Language Compatibility</a></li>
<li><a href="#session">Establishing a Session</a></li>
<li><a href="#query">Executing Queries</a></li>
<li><a href="#commit">Commits and Rollbacks</a></li>
<li><a href="#temptables">Temporary Tables</a></li>
<li><a href="#errors">Catching Errors</a></li>
<li><a href="#bindvars">Bind Variables</a></li>
<li><a href="#rebinding">Re-Binding and Re-Executing</a></li>
<li><a href="#fields">Accessing Fields in the Result Set</a></li>
<li><a href="#largeresultsets">Dealing With Large Result Sets</a></li>
<li><a href="#cursors">Cursors</a></li>
<li><a href="#columns">Getting Column Information</a></li>
<li><a href="#storedprocedures">Stored Procedures</a></li>
<li><a href="#extensions">Extensions</a></li>
<li><a href="#lastinsertid">Getting the Last Insert ID</a></li>
</ul>

<a name="languages"></a>
<span class="heading2">Language Compatibility</span><br><br>

<p>The SQL Relay ADO.NET Adapter is supported on Windows platforms using Visual Studio and on Unix/Linux using Mono.</p>

<p>The example code below is given in C# but the SQL Relay ADO.NET Adapter can be used from any language capable of using the .NET API.</p>

<a name="compiling"></a>
<span class="heading2">Compiling an SQL Relay Client Program</span><br><br>

<p>When writing an SQL Relay client program using the ADO.NET API, you need to
use the SQLRClient namespace.<p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>using</b></font>&nbsp;SQLRClient;<br>
</font>
</blockquote>

<p>You'll also need to include the SQLRelay.dll assembly.  This is usually found in C:\Program Files\Firstworks\bin on Windows or /usr/local/firstworks/lib on Unix/Linux.</p>

<p>As the ADO.NET Adapter ultimately relies on the C API, on Unix/Linux, there is also a SQLRelay.dll.config file, found in the same directory, that maps internal references to libsqlrclient.dll to the Unix/Linux equivalent shared object library.  This file isn't necessary on Windows and isn't installed.</p>

<p>To compile a progarm using the Visual Studio IDE, you just have to configure your project to include the SQLRelay.dll assembly and compile your program.</p>

<p>To compile from the command line using either Visual Studio or Mono, it's easiest to copy SQLRelay.dll into the current directory and build against it locally.<br/>When using Mono, you should also copy SQLRelay.dll.config into the current directory.</p>

<p>For example, to create the executable sqlrexample.exe from the source code sqlrexample.cs...</p>

<p>From the Visual Studio command line:</p>

<blockquote>
<pre>
copy "C:\Program Files\Firstworks\bin\SQLRClient.dll" .
csc /out:sqlrexample.exe sqlrexample.cs /reference:SQLRClient.dll
</pre>
</blockquote>

<p>Using the Mono compiler from the Unix/Linux command line:</p>

<blockquote>
<pre>
cp /usr/local/firstworks/lib/SQLRClient.dll .
cp /usr/local/firstworks/lib/SQLRClient.dll.config .
mcs -pkg:dotnet /out:sqlrexample.exe sqlrexample.cs /reference:SQLRClient.dll
</pre>
</blockquote>

<p>(Note that an explicit reference to the dotnet package is required with Mono).</p>

<p>To run the program under Windows, you can just run it directly:</p>

<blockquote>
<pre>
sqlrexample.exe
</pre>
</blockquote>

<p>Use the mono runtime to run the program on Unix/Linux:</p>

<blockquote>
<pre>
mono sqlrexample.exe
</pre>
</blockquote>

<p>If you get an error about libsqlrclient.dll not being found, then you probably forgot to copy SQLRClient.dll.config into the current directory.</p>

<a name="session"></a>
<span class="heading2">Establishing a Session</span><br><br>

<p>To use SQL Relay, you have to first open a connection.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>using</b></font>&nbsp;System;<br>
<font color="#a52a2a"><b>using</b></font>&nbsp;SQLRClient;<br>
<font color="#a52a2a"><b>using</b></font>&nbsp;System.Data;<br>
<font color="#a52a2a"><b>using</b></font>&nbsp;System.IO;<br>
<br>
<font color="#2e8b57"><b>namespace</b></font>&nbsp;SQLRExamples<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#2e8b57"><b>class</b></font>&nbsp;SQLRExample<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#2e8b57"><b>public</b></font>&nbsp;<font color="#2e8b57"><b>static</b></font>&nbsp;<font color="#2e8b57"><b>void</b></font>&nbsp;Main()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SQLRelayConnection sqlrcon =&nbsp;<font color="#a52a2a"><b>new</b></font>&nbsp;SQLRelayConnection(<font color="#ff00ff">&quot;Data Source=sqlrserver:9000;User ID=test;Password=test;Retry Time=0;Tries=1;Debug=false&quot;</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlrcon.Open();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
}<br>
</font>
</blockquote>

<p>The following connect string variables control attributes of the connection:</p>

<ul>
<li><b>Data Source</b> - The SQL Relay server to connect to.  This may be specified as <i>host:port</i>, <i>host:port:socket</i> or just <i>socket</i>.  If host, port and socket are all three specified, then a connection will first be attempted to the local socket and then to the host/port.</li>
<li><b>User ID</b> - The username to use when logging into SQL Relay.</li>
<li><b>Password</b> - The password to use when logging into SQL Relay.</li>
<li><b>Retry Time</b> - If a connection fails, it will be retried on this interval (in seconds).</li>
<li><b>Tries</b> - If a connection fails, it will be retried this many times.</li>
<li><b>Initial Catalog</b> - The database/schema to switch to after logging in.  Optional.</li>
<li><b>Debug</b> - If this is set to true then debug is enabled.</li>
</ul>

<p>In addition, the following connect string variables can be used to establish Kerberos or Active Directory encryption and authentication with the server:</p>

<p>See the <a href="../admin/configguide.html#krb">SQL Relay Configuration Guide</a> for more information about Kerberos and Active Directory configurations.  In particular, User ID and Password are not typically used when using Kerberos/AD.</p>

<ul>
<li><b>Krb</b> - Set to <b>yes</b> to enable Kerberos/AD encryption/authentication or <b>no</b> to disable it.</li>
<li><b>Krbservice</b> - Specifies the Kerberos service name of the SQL Relay server.  If omitted or left empty then the service name "sqlrelay" will be used. "sqlrelay" is the default service name of the SQL Relay server.  Note that on Windows platforms the service name must be fully qualified, including the host and realm name.  For example: "sqlrelay/sqlrserver.firstworks.com@AD.FIRSTWORKS.COM".</li>
<li><b>Krbmech</b> - Specifies the Kerberos mechanism to use.  On Linux/Unix platforms, this should be a string representation of the mechnaism's OID, such as: { 1 2 840 113554 1 2 2 }.  On Windows platforms, this should be a string like: Kerberos.  If omitted or left empty then the default mechanism will be used.  Only set this if you know that you have a good reason to.</li>
<li><b>Krbflags</b> - Specifies what Kerberos flags to use.  Multiple flags may be specified, separated by commas.  If left empty or NULL then a defalt set of flags will be used.  Only set this if you know that you have a good reason to.  Valid flags include: GSS_C_MUTUAL_FLAG, GSS_C_REPLAY_FLAG, GSS_C_SEQUENCE_FLAG, GSS_C_CONF_FLAG, and GSS_C_INTEG_FLAG.  For a full list of flags, consult the GSSAPI documentation, though note that only the previously listed flags are supported on Windows.</li>
</ul>

<p>The following connect string variables can be used to establish TLS/SSL encryption and authentication with the server:</p>

<p>See the <a href="../admin/configguide.html#tls">SQL Relay Configuration Guide</a> for more information about TLS/SSL configurations.</p>

<ul>
<li><b>Tls</b> - Set to <b>yes</b> to enable TLS/SSL encryption/authentication or <b>no</b> to disable it.</li>
<li><b>Tlsversion</b> - Specifies the TLS/SSL protocol version that the client will attempt to use.  Valid values include SSL2, SSL3, TLS1, TLS1.1, TLS1.2 or any more recent version of TLS, as supported by and enabled in the underlying TLS/SSL library.  If omittted or left empty then the highest supported version will be negotiated.</li>
<li><b>Tlscert</b> - Specifies the file name of the certificate chain file to send to the SQL Relay server.  This is only necessary if the SQL Relay server is configured to authenticate and authorize clients by certificate.</li>
<li><b>Tlspassword</b> - If Tlscert contains a password-protected private key, then Tlspassword may be supplied to access it.  If the private key is not password-protected, then this argument is ignored, and may be omitted or left empty.</li>
<li><b>Tlsciphers</b> - Specifies a list of ciphers to allow.  Ciphers may be separated by spaces, commas, or colons.  If omitted or left empty then a default set is used.  For a list of valid ciphers on Linux/Unix platforms, see: man ciphers. For a list of valid ciphers on Windows platforms, see <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa375549%28v=vs.85%29.aspx">this page</a>.  On Windows platforms, the ciphers (alg_id's) should omit CALG_ and may be given with underscores or dashes.  For example: 3DES_112.  Only set this if you know that you have a good reason to.</p>
<li><b>Tlsvalidate</b> - Indicates whether to validate the SQL Relay server's certificate, and may be set to one of the following: <b>no</b> - Don't validate the server's certificate.  <b>ca</b> - Validate that the server's certificate was signed by a trusted certificate authority.  <b>ca+host</b> - Perform "ca" validation and also validate that one of the subject altenate names (or the common name if no SANs are present) in the certificate matches the host provided in the Data Source parameter.  (Falls back to "ca" validation when a unix socket is used.)  <b>ca+domain</b> - Perform "ca" validation and also validate that the domain name of one of the subject alternate names (or the common name if no SANs are present) in the certificate matches the domain name of the host provided in the Data Source parameter.  (Falls back to "ca" validation when a unix socket is used.)</li>
<li><b>Tlsca</b> - Specifies the location of a certificate authority file to use, in addition to the system's root certificates, when validating the SQL Relay server's certificate.  This is useful if the SQL Relay server's certificate is self-signed.  On Windows, "ca" must be a file name.  On non-Windows systems, "ca" can be either a file or  directory name.  If it is a directory name, then all certificate authority files found in that directory will be used.  If it a file name, then only that file will be used.</li>
</ul>

<p>Note that the supported Tlscert and Tlsca file formats may vary between platforms.  A variety of file formats are generally supported on Linux/Unix platfoms (.pem, .pfx, etc.) but only the .pfx format is currently supported on Windows.</p>

<p>After opening  the connection, a session is established when the first 
query is run.</p>

<p>For the duration of the session, the client occupies one of the database
connections, so care should be taken to minimize the length of a
session.</p>

<a name="query"></a>
<span class="heading2">Executing Queries</span><br><br>

<p>There are three ways to execute queries.</p>

<p>If a query doesn't return a result set, such as DML (insert, update, delete, etc.) or DDL (create, drop, etc.) then you can use ExecuteNonQuery.  If the query returns a single value you can use ExecuteScalar.  If the query returns a result set then you must use ExecuteReader.</p>

<p>In any case, you must create an instance of SQLRelayCommand and set its CommandText.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>using</b></font>&nbsp;System;<br>
<font color="#a52a2a"><b>using</b></font>&nbsp;SQLRClient;<br>
<font color="#a52a2a"><b>using</b></font>&nbsp;System.Data;<br>
<font color="#a52a2a"><b>using</b></font>&nbsp;System.IO;<br>
<br>
<font color="#2e8b57"><b>namespace</b></font>&nbsp;SQLRExamples<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#2e8b57"><b>class</b></font>&nbsp;SQLRExample<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#2e8b57"><b>public</b></font>&nbsp;<font color="#2e8b57"><b>static</b></font>&nbsp;<font color="#2e8b57"><b>void</b></font>&nbsp;Main()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SQLRelayConnection sqlrcon =&nbsp;<font color="#a52a2a"><b>new</b></font>&nbsp;SQLRelayConnection(<font color="#ff00ff">&quot;Data Source=sqlrserver:9000;User ID=test;Password=test;Retry Time=0;Tries=1;Debug=false&quot;</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlrcon.Open();<br>
<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">// DML queries...</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SQLRelayCommand sqlrcom = (SQLRelayComand)sqlrcon.CreateCommand();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlrcom.CommandText =&nbsp;<font color="#ff00ff">&quot;insert into testtable values (1,'hello')&quot;</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#a52a2a"><b>try</b></font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlrcom.ExecuteNonQuery();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#a52a2a"><b>catch</b></font>&nbsp;(Exception ex)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;... handle exceptions ...<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">// Single values</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlrcom.CommandText =&nbsp;<font color="#ff00ff">&quot;select 1 from dual&quot;</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#a52a2a"><b>try</b></font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Int64&nbsp;<font color="#a52a2a"><b>value</b></font>&nbsp;= sqlrcom.ExecuteScalar();<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;<font color="#a52a2a"><b>do</b></font>&nbsp;something with the&nbsp;<font color="#a52a2a"><b>value</b></font>&nbsp;...<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#a52a2a"><b>catch</b></font>&nbsp;(Exception ex)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;... handle exceptions ...<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">// Multiple rows</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlrcom.CommandText =&nbsp;<font color="#ff00ff">&quot;select * from testtable&quot;</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#a52a2a"><b>try</b></font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.Data.IDataReader datareader = sqlrcom.ExecuteReader();<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;<font color="#a52a2a"><b>do</b></font>&nbsp;something with the result set ...<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#a52a2a"><b>catch</b></font>&nbsp;(Exception ex)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;... handle exceptions ...<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
}<br>
</font>
</blockquote>

<a name="commit"></a>
<span class="heading2">Commits and Rollbacks</span><br><br>

<p>If you need to execute a commit or rollback, you should create an instance of the SQLRelayTransaction class and use its commit() and rollback() methods rather than sending "commit" or "rollback" queries.  There are two reasons for this.  First, it's much more efficient to call the methods.  Second, if you're writing code that can run on transactional or non-transactional databases, some non-transactional databases will throw errors if they receive a "commit" or "rollback" query, but by calling the commit() and rollback() methods you instruct the database connection daemon to call the commit and rollback API methods for that database rather than issuing them as queries.  If the API's have no commit or rollback methods, the calls do nothing and the database throws no error.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>using</b></font>&nbsp;System;<br>
<font color="#a52a2a"><b>using</b></font>&nbsp;SQLRClient;<br>
<font color="#a52a2a"><b>using</b></font>&nbsp;System.Data;<br>
<font color="#a52a2a"><b>using</b></font>&nbsp;System.IO;<br>
<br>
<font color="#2e8b57"><b>namespace</b></font>&nbsp;SQLRExamples<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#2e8b57"><b>class</b></font>&nbsp;SQLRExample<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#2e8b57"><b>public</b></font>&nbsp;<font color="#2e8b57"><b>static</b></font>&nbsp;<font color="#2e8b57"><b>void</b></font>&nbsp;Main()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SQLRelayConnection sqlrcon =&nbsp;<font color="#a52a2a"><b>new</b></font>&nbsp;SQLRelayConnection(<font color="#ff00ff">&quot;Data Source=sqlrserver:9000;User ID=test;Password=test;Retry Time=0;Tries=1;Debug=false&quot;</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlrcon.Open();<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SQLRelayTransaction sqlrtran = sqlrcon.BeginTransaction();<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;... run some queries that we want to keep the results of ...<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlrtran.Commit();<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;... run some queries that we don't want to keep the results of ...<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlrtran.Rollback();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
}<br>
</font>
</blockquote>

<a name="temptables"></a>
<span class="heading2">Temporary Tables</span><br><br>

<p>Some databases support temporary tables.  That is, tables which are
automatically dropped or truncated when an application closes its connection
to the database or when a transaction is committed or rolled back.</p>

<p>For databases which drop or truncate tables when a transaction is committed
or rolled back, temporary tables work naturally.</p>

<p>However, for databases which drop or truncate tables when an application
closes its connection to the database, there is an issue.  Since SQL Relay
maintains persistent database connections, when an application disconnects from
SQL Relay, the connection between SQL Relay and the database remains, so
the database does not know to drop or truncate the table.  To remedy this
situation, SQL Relay parses each query to see if it created a temporary table,
keeps a list of temporary tables and drops (or truncates them) when the
application disconnects from SQL Relay.  Since each database has slightly
different syntax for creating a temporary table, SQL Relay parses each query
according to the rules for that database.</p>

<p>In effect, temporary tables should work when an application connects to
SQL Relay in the same manner that they would work if the application connected
directly to the database.</p>

<a name="errors"></a>
<span class="heading2">Catching Errors</span><br><br>

<p>If your calls to ExecuteNonQuery, ExecuteScaler or ExecuteReader fail, you can catch the error an exception.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>using</b></font>&nbsp;System;<br>
<font color="#a52a2a"><b>using</b></font>&nbsp;SQLRClient;<br>
<font color="#a52a2a"><b>using</b></font>&nbsp;System.Data;<br>
<font color="#a52a2a"><b>using</b></font>&nbsp;System.IO;<br>
<br>
<font color="#2e8b57"><b>namespace</b></font>&nbsp;SQLRExamples<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#2e8b57"><b>class</b></font>&nbsp;SQLRExample<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#2e8b57"><b>public</b></font>&nbsp;<font color="#2e8b57"><b>static</b></font>&nbsp;<font color="#2e8b57"><b>void</b></font>&nbsp;Main()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SQLRelayConnection sqlrcon =&nbsp;<font color="#a52a2a"><b>new</b></font>&nbsp;SQLRelayConnection(<font color="#ff00ff">&quot;Data Source=sqlrserver:9000;User ID=test;Password=test;Retry Time=0;Tries=1;Debug=false&quot;</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlrcon.Open();<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SQLRelayCommand sqlrcom = (SQLRelayComand)sqlrcon.CreateCommand();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlrcom.CommandText =&nbsp;<font color="#ff00ff">&quot;insert into testtable values (1,'hello')&quot;</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#a52a2a"><b>try</b></font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlrcom.ExecuteNonQuery();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#a52a2a"><b>catch</b></font>&nbsp;(Exception ex)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Console.WriteLine(ex.Message);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
}<br>
</font>
</blockquote>

<a name="bindvars"></a>
<span class="heading2">Bind Variables</span><br><br>

<p>Programs rarely execute fixed queries.  More often than not, some part
of the query is dynamically generated.  The ADO.NET API provides means
for using bind variables (also known as parameters) in those queries.</p>

<p>For a detailed discussion of binds, see 
<a href="binds.html">this document</a>.</p>

<p>To use bind variables (parameters) with the ADO.NET API, you must add variable/value pairs to the parameter collection associated with each instance of SQLRelayCommand.  For numeric, string or date variables, this is straightforward, you can just use the Parameters.Add() method.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>using</b></font>&nbsp;System;<br>
<font color="#a52a2a"><b>using</b></font>&nbsp;SQLRClient;<br>
<font color="#a52a2a"><b>using</b></font>&nbsp;System.Data;<br>
<font color="#a52a2a"><b>using</b></font>&nbsp;System.IO;<br>
<br>
<font color="#2e8b57"><b>namespace</b></font>&nbsp;SQLRExamples<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#2e8b57"><b>class</b></font>&nbsp;SQLRExample<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#2e8b57"><b>public</b></font>&nbsp;<font color="#2e8b57"><b>static</b></font>&nbsp;<font color="#2e8b57"><b>void</b></font>&nbsp;Main()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SQLRelayConnection sqlrcon =&nbsp;<font color="#a52a2a"><b>new</b></font>&nbsp;SQLRelayConnection(<font color="#ff00ff">&quot;Data Source=sqlrserver:9000;User ID=test;Password=test;Retry Time=0;Tries=1;Debug=false&quot;</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlrcon.Open();<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SQLRelayCommand sqlrcom = (SQLRelayComand)sqlrcon.CreateCommand();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlrcom.CommandText =&nbsp;<font color="#ff00ff">&quot;insert into testtable values (:var1,:var2,:var3)&quot;</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;var1&quot;</font>,&nbsp;<font color="#ff00ff">1</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;var2&quot;</font>,&nbsp;<font color="#ff00ff">&quot;hello&quot;</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;var2&quot;</font>,&nbsp;<font color="#a52a2a"><b>new</b></font>&nbsp;DateTime(<font color="#ff00ff">2001</font>,&nbsp;<font color="#ff00ff">1</font>,&nbsp;<font color="#ff00ff">1</font>,&nbsp;<font color="#ff00ff">0</font>,&nbsp;<font color="#ff00ff">0</font>,&nbsp;<font color="#ff00ff">0</font>));<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#a52a2a"><b>try</b></font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlrcom.ExecuteNonQuery();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#a52a2a"><b>catch</b></font>&nbsp;(Exception ex)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Console.WriteLine(ex.Message);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
}<br>
</font>
</blockquote>

<p>You can also bind CLOB's and BLOB's.  It is a little more complex but not terribly.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>using</b></font>&nbsp;System;<br>
<font color="#a52a2a"><b>using</b></font>&nbsp;SQLRClient;<br>
<font color="#a52a2a"><b>using</b></font>&nbsp;System.Data;<br>
<font color="#a52a2a"><b>using</b></font>&nbsp;System.IO;<br>
<br>
<font color="#2e8b57"><b>namespace</b></font>&nbsp;SQLRExamples<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#2e8b57"><b>class</b></font>&nbsp;SQLRExample<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#2e8b57"><b>public</b></font>&nbsp;<font color="#2e8b57"><b>static</b></font>&nbsp;<font color="#2e8b57"><b>void</b></font>&nbsp;Main()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SQLRelayConnection sqlrcon =&nbsp;<font color="#a52a2a"><b>new</b></font>&nbsp;SQLRelayConnection(<font color="#ff00ff">&quot;Data Source=sqlrserver:9000;User ID=test;Password=test;Retry Time=0;Tries=1;Debug=false&quot;</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlrcon.Open();<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SQLRelayCommand sqlrcom = (SQLRelayComand)sqlrcon.CreateCommand();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlrcom.CommandText =&nbsp;<font color="#ff00ff">&quot;insert into testtable values (:clobvar,:blobvar)&quot;</font>;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SQLRelayParameter clobvar =&nbsp;<font color="#a52a2a"><b>new</b></font>&nbsp;SQLRelayParameter();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clobvar.ParameterName =&nbsp;<font color="#ff00ff">&quot;clobvar&quot;</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clobvar.Value =&nbsp;<font color="#ff00ff">&quot;testclob&quot;</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clobvar.SQLRelayType = SQLRelayType.Clob;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlrcom.Parameters.Add(clobvar);<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SQLRelayParameter blobvar =&nbsp;<font color="#a52a2a"><b>new</b></font>&nbsp;SQLRelayParameter();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;blobvar.ParameterName =&nbsp;<font color="#ff00ff">&quot;blobvar&quot;</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;blobvar.Value = System.Text.Encoding.Default.GetBytes(<font color="#ff00ff">&quot;testblob&quot;</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;blobvar.SQLRelayType = SQLRelayType.Blob;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlrcom.Parameters.Add(blobvar);<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#a52a2a"><b>try</b></font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlrcom.ExecuteNonQuery();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#a52a2a"><b>catch</b></font>&nbsp;(Exception ex)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Console.WriteLine(ex.Message);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
}<br>
</font>
</blockquote>

<p>Note that in the above code, the Parameter.SQLRelayType must be set rather than Parameter.DbType, which would generally be set.  DbType is constrained to a set of values defined in the ADO.NET spec, which does not include Clob or Blob types.</p>

<p>Output bind variables can be used too.  The Direction and DbType attributes of the parameter must be specified though and for strings, the Size of the buffer to allocate for the return value must be specified as well.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>using</b></font>&nbsp;System;<br>
<font color="#a52a2a"><b>using</b></font>&nbsp;SQLRClient;<br>
<font color="#a52a2a"><b>using</b></font>&nbsp;System.Data;<br>
<font color="#a52a2a"><b>using</b></font>&nbsp;System.IO;<br>
<br>
<font color="#2e8b57"><b>namespace</b></font>&nbsp;SQLRExamples<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#2e8b57"><b>class</b></font>&nbsp;SQLRExample<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#2e8b57"><b>public</b></font>&nbsp;<font color="#2e8b57"><b>static</b></font>&nbsp;<font color="#2e8b57"><b>void</b></font>&nbsp;Main()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SQLRelayConnection sqlrcon =&nbsp;<font color="#a52a2a"><b>new</b></font>&nbsp;SQLRelayConnection(<font color="#ff00ff">&quot;Data Source=sqlrserver:9000;User ID=test;Password=test;Retry Time=0;Tries=1;Debug=false&quot;</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlrcon.Open();<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SQLRelayCommand sqlrcom = (SQLRelayComand)sqlrcon.CreateCommand();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlrcom.CommandText =&nbsp;<font color="#ff00ff">&quot;begin&nbsp;&nbsp;:numvar:=1;&nbsp;&nbsp;:stringvar:='hello';&nbsp;&nbsp;:floatvar:=2.5;&nbsp;&nbsp;:datevar:='03-FEB-2001'; end;&quot;</font>;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SQLRelayParameter numvar =&nbsp;<font color="#a52a2a"><b>new</b></font>&nbsp;SQLRelayParameter();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;numvar.ParameterName =&nbsp;<font color="#ff00ff">&quot;numvar&quot;</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;numvar.Direction = ParameterDirection.Output;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;numvar.DbType = DbType.Int64;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlrcom.Parameters.Add(numvar);<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SQLRelayParameter stringvar =&nbsp;<font color="#a52a2a"><b>new</b></font>&nbsp;SQLRelayParameter();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stringvar.ParameterName =&nbsp;<font color="#ff00ff">&quot;stringvar&quot;</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stringvar.Direction = ParameterDirection.Output;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stringvar.DbType = DbType.String;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stringvar.Size =&nbsp;<font color="#ff00ff">20</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlrcom.Parameters.Add(stringvar);<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SQLRelayParameter floatvar =&nbsp;<font color="#a52a2a"><b>new</b></font>&nbsp;SQLRelayParameter();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;floatvar.ParameterName =&nbsp;<font color="#ff00ff">&quot;floatvar&quot;</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;floatvar.Direction = ParameterDirection.Output;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;floatvar.DbType = DbType.Double;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlrcom.Parameters.Add(floatvar);<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SQLRelayParameter datevar =&nbsp;<font color="#a52a2a"><b>new</b></font>&nbsp;SQLRelayParameter();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;datevar.ParameterName =&nbsp;<font color="#ff00ff">&quot;datevar&quot;</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;datevar.Direction = ParameterDirection.Output;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;datevar.DbType = DbType.DateTime;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlrcom.Parameters.Add(datevar);<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#a52a2a"><b>try</b></font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlrcom.ExecuteNonQuery();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#a52a2a"><b>catch</b></font>&nbsp;(Exception ex)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Console.WriteLine(ex.Message);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;<font color="#a52a2a"><b>do</b></font>&nbsp;something with numvar.Value ...<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;<font color="#a52a2a"><b>do</b></font>&nbsp;something with stringvar.Value ...<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;<font color="#a52a2a"><b>do</b></font>&nbsp;something with floatvar.Value ...<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;<font color="#a52a2a"><b>do</b></font>&nbsp;something with datevar.Value ...<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
}<br>
</font>
</blockquote>

<p>FIXME: ... clob, blob and cursor output bind ...</p>

<a name="rebinding"></a>
<span class="heading2">Re-Binding and Re-Execution</span><br><br>

<p>A feature of the prepare/bind/execute paradigm is the ability to prepare, 
bind and execute a query once, then re-bind and re-execute the query 
over and over without re-preparing it.  If your backend database natively 
supports this paradigm, you can reap a substantial performance improvement.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>using</b></font>&nbsp;System;<br>
<font color="#a52a2a"><b>using</b></font>&nbsp;SQLRClient;<br>
<font color="#a52a2a"><b>using</b></font>&nbsp;System.Data;<br>
<font color="#a52a2a"><b>using</b></font>&nbsp;System.IO;<br>
<br>
<font color="#2e8b57"><b>namespace</b></font>&nbsp;SQLRExamples<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#2e8b57"><b>class</b></font>&nbsp;SQLRExample<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#2e8b57"><b>public</b></font>&nbsp;<font color="#2e8b57"><b>static</b></font>&nbsp;<font color="#2e8b57"><b>void</b></font>&nbsp;Main()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SQLRelayConnection sqlrcon =&nbsp;<font color="#a52a2a"><b>new</b></font>&nbsp;SQLRelayConnection(<font color="#ff00ff">&quot;Data Source=sqlrserver:9000;User ID=test;Password=test;Retry Time=0;Tries=1;Debug=false&quot;</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlrcon.Open();<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">// Prepare the query...</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SQLRelayCommand sqlrcom = (SQLRelayComand)sqlrcon.CreateCommand();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlrcom.CommandText =&nbsp;<font color="#ff00ff">&quot;insert into testtable values (:var1,:var2,:var3)&quot;</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlrcom.Prepare();<br>
<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">// Execute once...</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;var1&quot;</font>,&nbsp;<font color="#ff00ff">1</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;var2&quot;</font>,&nbsp;<font color="#ff00ff">&quot;hello&quot;</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;var2&quot;</font>,&nbsp;<font color="#a52a2a"><b>new</b></font>&nbsp;DateTime(<font color="#ff00ff">2001</font>,&nbsp;<font color="#ff00ff">1</font>,&nbsp;<font color="#ff00ff">1</font>,&nbsp;<font color="#ff00ff">0</font>,&nbsp;<font color="#ff00ff">0</font>,&nbsp;<font color="#ff00ff">0</font>));<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#a52a2a"><b>try</b></font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlrcom.ExecuteNonQuery();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#a52a2a"><b>catch</b></font>&nbsp;(Exception ex)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Console.WriteLine(ex.Message);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlrcom.Parameters.Clear();<br>
<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">// Execute again with new values...</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;var1&quot;</font>,&nbsp;<font color="#ff00ff">2</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;var2&quot;</font>,&nbsp;<font color="#ff00ff">&quot;bye&quot;</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;var2&quot;</font>,&nbsp;<font color="#a52a2a"><b>new</b></font>&nbsp;DateTime(<font color="#ff00ff">2002</font>,&nbsp;<font color="#ff00ff">2</font>,&nbsp;<font color="#ff00ff">2</font>,&nbsp;<font color="#ff00ff">0</font>,&nbsp;<font color="#ff00ff">0</font>,&nbsp;<font color="#ff00ff">0</font>));<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#a52a2a"><b>try</b></font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlrcom.ExecuteNonQuery();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#a52a2a"><b>catch</b></font>&nbsp;(Exception ex)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Console.WriteLine(ex.Message);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;... re-bind and re-execute again and again ...<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
}<br>
</font>
</blockquote>

<a name="fields"></a>
<span class="heading2">Accessing Fields in the Result Set</span><br><br>

<p>Once returned from an ExecuteReader call, the SQLRelayDataReader provides methods for accessing the fields of the result set.</p>

<p>To fetch a row, call the Read() method.  This method will return false if no more rows are available.</p>

<p>After the row has been fetched, individual fields of that row may be accessed through a wide variety of methods.  The raw data for each field can be accessed by index using GetValue(), as a numeric array returned by the GetValues() or by using the SQLRelayDataReader directly as either a numeric or associative array.  The GetOrdinal() method can also be used to get the numeric index of a column name as well.</p>

<p>Further, the raw data for each field can be coaxed into a native type using the GetBoolean(), GetByte(), GetBytes(), GetChar(), GetChars(), GetGuid(), GetInt16(), GetInt32(), GetInt64(), GetFloat(), GetDouble(), GetString(), GetDecimal() and GetDateTime() methods.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>using</b></font>&nbsp;System;<br>
<font color="#a52a2a"><b>using</b></font>&nbsp;SQLRClient;<br>
<font color="#a52a2a"><b>using</b></font>&nbsp;System.Data;<br>
<font color="#a52a2a"><b>using</b></font>&nbsp;System.IO;<br>
<br>
<font color="#2e8b57"><b>namespace</b></font>&nbsp;SQLRExamples<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#2e8b57"><b>class</b></font>&nbsp;SQLRExample<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#2e8b57"><b>public</b></font>&nbsp;<font color="#2e8b57"><b>static</b></font>&nbsp;<font color="#2e8b57"><b>void</b></font>&nbsp;Main()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SQLRelayConnection sqlrcon =&nbsp;<font color="#a52a2a"><b>new</b></font>&nbsp;SQLRelayConnection(<font color="#ff00ff">&quot;Data Source=sqlrserver:9000;User ID=test;Password=test;Retry Time=0;Tries=1;Debug=false&quot;</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlrcon.Open();<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SQLRelayCommand sqlrcom = (SQLRelayComand)sqlrcon.CreateCommand();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlrcom.CommandText =&nbsp;<font color="#ff00ff">&quot;select col1,col2 from testtable&quot;</font>;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#a52a2a"><b>try</b></font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.Data.IDataReader datareader = sqlrcom.ExecuteReader();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">// read row...</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;datareader.Read();<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">// get the raw data of the first field in a variety of ways</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Object o1 = datareader.GetValue(<font color="#ff00ff">0</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o1 = datareader[<font color="#ff00ff">0</font>];<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o1 = datareader.GetValue(datareader.GetOrdinal(<font color="#ff00ff">&quot;col1&quot;</font>));<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o1 = datareader[<font color="#ff00ff">&quot;col1&quot;</font>];<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Object[] os1 = datareader.GetValues();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o1 = os1[<font color="#ff00ff">0</font>];<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">// get the first field as a string</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String s1 = datareader.GetString(<font color="#ff00ff">0</font>);<br>
<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">// get the raw data of the second field in a variety of ways</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Object o2 = datareader.GetValue(<font color="#ff00ff">1</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o2 = datareader[<font color="#ff00ff">1</font>];<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o2 = datareader.GetValue(datareader.GetOrdinal(<font color="#ff00ff">&quot;col2&quot;</font>));<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o2 = datareader[<font color="#ff00ff">&quot;col2&quot;</font>];<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Object[] os2 = datareader.GetValues();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o2 = os2[<font color="#ff00ff">1</font>];<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">// get the second field as a string</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String s2 = datareader.GetString(<font color="#ff00ff">1</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">// read another row...</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;datareader.Read();<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;<font color="#a52a2a"><b>do</b></font>&nbsp;something with&nbsp;<font color="#a52a2a"><b>this</b></font>&nbsp;row ...<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;... fetch more rows ...<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#a52a2a"><b>catch</b></font>&nbsp;(Exception ex)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Console.WriteLine(ex.Message);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
}<br>
</font>
</blockquote>


<a name="largeresultsets"></a>
<span class="heading2">Dealing With Large Result Sets</span><br><br>

<p>SQL Relay normally buffers the entire result set.  This can speed things up 
at the cost of memory.  With large enough result sets, it makes sense to buffer the result set in chunks instead of all at once.</p>

<p>Use the parameter SQLRelayCommand.ResultSetBufferSize to set the number of rows to buffer at a time.  Calls to SQLRelayDataReader.Read() cause the chunk containing the requested field to be fetched.</p>

<a name="cursors"></a>
<span class="heading2">Cursors</span><br><br>

<p>Cursors make it possible to execute queries while processing the result
set of another query.  You can select rows from a table in one query, then 
iterate through its result set, inserting rows into another table, using only 
1 database connection for both operations.</p>

<p>In the ADO.NET API, cursors are abstracted by the SQLRelayCommand class.  Each SQLRelayCommand can be thought of as a separate cursor and in many cases, each SQLRelayCommand consumes a separate server-side cursor.</p>

<p>For example:</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>using</b></font>&nbsp;System;<br>
<font color="#a52a2a"><b>using</b></font>&nbsp;SQLRClient;<br>
<font color="#a52a2a"><b>using</b></font>&nbsp;System.Data;<br>
<font color="#a52a2a"><b>using</b></font>&nbsp;System.IO;<br>
<br>
<font color="#2e8b57"><b>namespace</b></font>&nbsp;SQLRExamples<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#2e8b57"><b>class</b></font>&nbsp;SQLRExample<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#2e8b57"><b>public</b></font>&nbsp;<font color="#2e8b57"><b>static</b></font>&nbsp;<font color="#2e8b57"><b>void</b></font>&nbsp;Main()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SQLRelayConnection sqlrcon =&nbsp;<font color="#a52a2a"><b>new</b></font>&nbsp;SQLRelayConnection(<font color="#ff00ff">&quot;Data Source=sqlrserver:9000;User ID=test;Password=test;Retry Time=0;Tries=1;Debug=false&quot;</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlrcon.Open();<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SQLRelayCommand sqlrcom1 = (SQLRelayComand)sqlrcon.CreateCommand();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlrcom1.CommandText =&nbsp;<font color="#ff00ff">&quot;select * from my_first_table&quot;</font>;<br>
<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SQLRelayCommand sqlrcom2 = (SQLRelayComand)sqlrcon.CreateCommand();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlrcom2.CommandText =&nbsp;<font color="#ff00ff">&quot;insert into my_second_table values (:col1, :col2, :col3)&quot;</font>;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#a52a2a"><b>try</b></font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.Data.IDataReader datareader = sqlrcom1.ExecuteReader();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#a52a2a"><b>while</b></font>&nbsp;(datareader.Read())<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlrcom2.Parameters.Clear();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlrcom2.Parameters.Add(<font color="#ff00ff">&quot;col1&quot;</font>,datareader.GetString(<font color="#ff00ff">0</font>));<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlrcom2.Parameters.Add(<font color="#ff00ff">&quot;col2&quot;</font>,datareader.GetString(<font color="#ff00ff">1</font>));<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlrcom2.Parameters.Add(<font color="#ff00ff">&quot;col3&quot;</font>,datareader.GetString(<font color="#ff00ff">2</font>));<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#a52a2a"><b>try</b></font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlrcom2.ExecuteNonQuery();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#a52a2a"><b>catch</b></font>&nbsp;(Exception ex)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Console.WriteLine(ex.Message);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#a52a2a"><b>catch</b></font>&nbsp;(Exception ex)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Console.WriteLine(ex.Message);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
}<br>
</font>
</blockquote>

<a name="columns"></a>
<span class="heading2">Getting Column Information</span><br><br>

<p>After executing a query, the column count is stored in the FieldCount property of the SQLRelayDataReader class.  Column names are accessible via the GetName() method.  Column types are available from the GetDataTypeName().  The native .NET data type for the field is avialable from the GetFieldType() method.  They may be used as follows:</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>using</b></font>&nbsp;System;<br>
<font color="#a52a2a"><b>using</b></font>&nbsp;SQLRClient;<br>
<font color="#a52a2a"><b>using</b></font>&nbsp;System.Data;<br>
<font color="#a52a2a"><b>using</b></font>&nbsp;System.IO;<br>
<br>
<font color="#2e8b57"><b>namespace</b></font>&nbsp;SQLRExamples<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#2e8b57"><b>class</b></font>&nbsp;SQLRExample<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#2e8b57"><b>public</b></font>&nbsp;<font color="#2e8b57"><b>static</b></font>&nbsp;<font color="#2e8b57"><b>void</b></font>&nbsp;Main()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SQLRelayConnection sqlrcon =&nbsp;<font color="#a52a2a"><b>new</b></font>&nbsp;SQLRelayConnection(<font color="#ff00ff">&quot;Data Source=sqlrserver:9000;User ID=test;Password=test;Retry Time=0;Tries=1;Debug=false&quot;</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlrcon.Open();<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SQLRelayCommand sqlrcom = (SQLRelayComand)sqlrcon.CreateCommand();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlrcom.CommandText =&nbsp;<font color="#ff00ff">&quot;select * from my_first_table&quot;</font>;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#a52a2a"><b>try</b></font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.Data.IDataReader datareader = sqlrcom.ExecuteReader();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#a52a2a"><b>for</b></font>&nbsp;(UInt32 index =&nbsp;<font color="#ff00ff">0</font>; index &amp;lt; sqlrcom.FieldCount; index++)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String name = datareader.GetName(index);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String datatype = datareader.GetDataTypename(index);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String nativedatatype = datareader.GetFieldType(index).ToString();<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;<font color="#a52a2a"><b>do</b></font>&nbsp;someting with the column data ...<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#a52a2a"><b>catch</b></font>&nbsp;(Exception ex)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Console.WriteLine(ex.Message);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
}<br>
</font>
</blockquote>

<p>Extended column information is available from the GetSchemaTable method.  Usage is best illustrated by example.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>using</b></font>&nbsp;System;<br>
<font color="#a52a2a"><b>using</b></font>&nbsp;SQLRClient;<br>
<font color="#a52a2a"><b>using</b></font>&nbsp;System.Data;<br>
<font color="#a52a2a"><b>using</b></font>&nbsp;System.IO;<br>
<br>
<font color="#2e8b57"><b>namespace</b></font>&nbsp;SQLRExamples<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#2e8b57"><b>class</b></font>&nbsp;SQLRExample<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#2e8b57"><b>public</b></font>&nbsp;<font color="#2e8b57"><b>static</b></font>&nbsp;<font color="#2e8b57"><b>void</b></font>&nbsp;Main()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SQLRelayConnection sqlrcon =&nbsp;<font color="#a52a2a"><b>new</b></font>&nbsp;SQLRelayConnection(<font color="#ff00ff">&quot;Data Source=sqlrserver:9000;User ID=test;Password=test;Retry Time=0;Tries=1;Debug=false&quot;</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlrcon.Open();<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SQLRelayCommand sqlrcom = (SQLRelayComand)sqlrcon.CreateCommand();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlrcom.CommandText =&nbsp;<font color="#ff00ff">&quot;select * from my_first_table&quot;</font>;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#a52a2a"><b>try</b></font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.Data.IDataReader datareader = sqlrcom.ExecuteReader();<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DataTable schematable = datareader.GetSchemaTable();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#a52a2a"><b>for</b></font>&nbsp;(UInt32 index =&nbsp;<font color="#ff00ff">0</font>; index &amp;lt; sqlrcom.FieldCount; index++)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String columnname = Convert.ToString(schematable.Rows[index][<font color="#ff00ff">&quot;ColumnName&quot;</font>]);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Int64 columnordinal = Convert.ToInt64(schematable.Rows[index][<font color="#ff00ff">&quot;ColumnOrdinal&quot;</font>]);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Int64 columnsize = Convert.ToInt64(schematable.Rows[index][<font color="#ff00ff">&quot;ColumnSize&quot;</font>]);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Int64 numericprecision = Convert.ToInt64(schematable.Rows[index][<font color="#ff00ff">&quot;NumericPrecision&quot;</font>]);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Int64 numericscale = Convert.ToInt64(schematable.Rows[index][<font color="#ff00ff">&quot;NumericScale&quot;</font>]);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Boolean isunique = Convert.ToBoolean(schematable.Rows[index][<font color="#ff00ff">&quot;IsUnique&quot;</font>]);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Boolean iskey = Convert.ToBoolean(schematable.Rows[index][<font color="#ff00ff">&quot;IsKey&quot;</font>]);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String baseservername = Convert.ToString(schematable.Rows[index][<font color="#ff00ff">&quot;BaseServerName&quot;</font>]);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String basecatalogname = Convert.ToString(schematable.Rows[index][<font color="#ff00ff">&quot;BaseCatalogName&quot;</font>]);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String basecolumnname = Convert.ToString(schematable.Rows[index][<font color="#ff00ff">&quot;BaseColumnName&quot;</font>]);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String baseschemaname = Convert.ToString(schematable.Rows[index][<font color="#ff00ff">&quot;BaseSchemaName&quot;</font>]);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String basetablename = Convert.ToString(schematable.Rows[index][<font color="#ff00ff">&quot;BaseTableName&quot;</font>]);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String datatype = Convert.ToString(schematable.Rows[index][<font color="#ff00ff">&quot;DataType&quot;</font>]);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Boolean allowdbnull = Convert.ToBoolean(schematable.Rows[index][<font color="#ff00ff">&quot;AllowDBNull&quot;</font>]);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String providertype = Convert.ToString(schematable.Rows[index][<font color="#ff00ff">&quot;ProviderType&quot;</font>]);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Boolean isaliased = Convert.ToBoolean(schematable.Rows[index][<font color="#ff00ff">&quot;IsAliased&quot;</font>]);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Boolean isexpression = Convert.ToBoolean(schematable.Rows[index][<font color="#ff00ff">&quot;IsExpression&quot;</font>]);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Boolean isidentity = Convert.ToBoolean(schematable.Rows[index][<font color="#ff00ff">&quot;IsIdentity&quot;</font>]);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Boolean isautoincrement = Convert.ToBoolean(schematable.Rows[index][<font color="#ff00ff">&quot;IsAutoIncrement&quot;</font>]);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Boolean isrowversion = Convert.ToBoolean(schematable.Rows[index][<font color="#ff00ff">&quot;IsRowVersion&quot;</font>]);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Boolean ishidden = Convert.ToBoolean(schematable.Rows[index][<font color="#ff00ff">&quot;IsHidden&quot;</font>]);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Boolean islong = Convert.ToBoolean(schematable.Rows[index][<font color="#ff00ff">&quot;IsLong&quot;</font>]);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Boolean isreadonly = Convert.ToBoolean(schematable.Rows[index][<font color="#ff00ff">&quot;IsReadOnly&quot;</font>]);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String providerspecificdatatype = Convert.ToString(schematable.Rows[index][<font color="#ff00ff">&quot;ProviderSpecificDataType&quot;</font>]);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String datatypename = Convert.ToString(schematable.Rows[index][<font color="#ff00ff">&quot;DataTypeName&quot;</font>]);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String xmlschemacollectiondatabase = Convert.ToString(schematable.Rows[index][<font color="#ff00ff">&quot;XmlSchemaCollectionDatabase&quot;</font>]);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String xmlschemacollectionowningschema = Convert.ToString(schematable.Rows[index][<font color="#ff00ff">&quot;XmlSchemaCollectionOwningSchema&quot;</font>]);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String xmlschemacollectionname = Convert.ToString(schematable.Rows[index][<font color="#ff00ff">&quot;XmlSchemaCollectionName&quot;</font>]);<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;<font color="#a52a2a"><b>do</b></font>&nbsp;something with all these bits of information ...<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#a52a2a"><b>catch</b></font>&nbsp;(Exception ex)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Console.WriteLine(ex.Message);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
}<br>
</font>
</blockquote>

<p>SQL Relay support most of the fields that might be returned in the schema table but not all.  Most databases don't support all of these fields either.  In the future, support may improve.</p>

<a name="storedprocedures"></a>
<span class="heading2">Stored Procedures</span><br><br>

<p>Many databases support stored procedures.  Stored procedures are sets of
queries and procedural code that are executed inside of the database itself.
For example, a stored procedure may select rows from one table, iterate through
the result set and, based on the values in each row, insert, update or delete
rows in other tables.  A client program could do this as well, but a stored
procedure is generally more efficient because queries and result sets don't
have to be sent back and forth between the client and database.  Also, stored
procedures are generally stored in the database in a compiled state, while
queries may have to be re-parsed and re-compiled each time they are sent.</p>

<p>While many databases support stored procedures.  The syntax for creating
and executing stored procedures varies greatly between databases.</p>

<p>Stored procedures typically take input paramters from client programs through
input bind variables and return values back to client programs either through
bind variables or result sets.  Stored procedures can be broken down into
several categories, based on the values that they return.  Some stored
procedures don't return any values, some return a single value, some return
multiple values and some return entire result sets.</p>

<span class="heading3">No Values</span><br>

<p>Some stored procedures don't return any values.  Below are examples,
illustrating how to create, execute and drop this kind of stored procedure for
each database that SQL Relay supports.</p>

<span class="heading4">Oracle</span><br>

<p>To create the stored procedure, run a query like the following.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>create</b></font>&nbsp;<font color="#6a5acd">procedure</font>&nbsp;testproc(in1&nbsp;<font color="#a52a2a"><b>in</b></font>&nbsp;<font color="#2e8b57"><b>number</b></font>, in2&nbsp;<font color="#a52a2a"><b>in</b></font>&nbsp;<font color="#2e8b57"><b>number</b></font>, in3&nbsp;<font color="#a52a2a"><b>in</b></font>&nbsp;<font color="#2e8b57"><b>varchar2</b></font>)&nbsp;<font color="#6a5acd">is</font><br>
<font color="#6a5acd">begin</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#a52a2a"><b>insert</b></font>&nbsp;<font color="#6a5acd">into</font>&nbsp;mytable&nbsp;<font color="#6a5acd">values</font>&nbsp;(in1,in2,in3);<br>
<font color="#6a5acd">end</font>;<br>
</font>
</blockquote>

<p>To execute the stored procedure from an SQL Relay program, use code like the
following.</p>

<blockquote>


<font face="monospace">
SQLRelayCommand sqlrcom = (SQLRelayComand)sqlrcon.CreateCommand();<br>
sqlrcom.CommandText =&nbsp;<font color="#ff00ff">&quot;begin testproc(:in1,:in2,:in3); end;&quot;</font>;<br>
sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;in1&quot;</font>,<font color="#ff00ff">1</font>);<br>
sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;in2&quot;</font>,<font color="#ff00ff">1.1</font>);<br>
sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;in3&quot;</font>,<font color="#ff00ff">&quot;hello&quot;</font>);<br>
sqlrcom.ExecuteNonQuery();<br>
</font>
</blockquote>

<p>To drop the stored procedure, run a query like the following.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>drop</b></font>&nbsp;<font color="#6a5acd">procedure</font>&nbsp;testproc<br>
</font>
</blockquote>


<span class="heading4">Sybase and Microsoft SQL Server</span><br>

<p>To create the stored procedure, run a query like the following.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>create</b></font>&nbsp;<font color="#6a5acd">procedure</font>&nbsp;testproc @in1 int, @in2&nbsp;<font color="#2e8b57"><b>float</b></font>, @in3&nbsp;<font color="#2e8b57"><b>varchar</b></font>(<font color="#ff00ff">20</font>)&nbsp;<font color="#6a5acd">as</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#a52a2a"><b>insert</b></font>&nbsp;<font color="#6a5acd">into</font>&nbsp;mytable&nbsp;<font color="#6a5acd">values</font>&nbsp;(@in1,@in2,@in3)<br>
</font>
</blockquote>

<p>To execute the stored procedure from an SQL Relay program, use code like the
following.</p>

<blockquote>


<font face="monospace">
SQLRelayCommand sqlrcom = (SQLRelayComand)sqlrcon.CreateCommand();<br>
sqlrcom.CommandText =&nbsp;<font color="#ff00ff">&quot;exec testproc&quot;</font>;<br>
sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;in1&quot;</font>,<font color="#ff00ff">1</font>);<br>
sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;in2&quot;</font>,<font color="#ff00ff">1.1</font>);<br>
sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;in3&quot;</font>,<font color="#ff00ff">&quot;hello&quot;</font>);<br>
sqlrcom.ExecuteNonQuery();<br>
</font>
</blockquote>

<p>To drop the stored procedure, run a query like the following.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>drop</b></font>&nbsp;<font color="#6a5acd">procedure</font>&nbsp;testproc<br>
</font>
</blockquote>

<span class="heading4">Firebird</span><br>

<p>To create the stored procedure, run a query like the following.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>create</b></font>&nbsp;<font color="#6a5acd">procedure</font>&nbsp;testproc(in1&nbsp;<font color="#2e8b57"><b>integer</b></font>, in2&nbsp;<font color="#2e8b57"><b>float</b></font>, in3&nbsp;<font color="#2e8b57"><b>varchar</b></font>(<font color="#ff00ff">20</font>))&nbsp;<font color="#6a5acd">as</font><br>
<font color="#6a5acd">begin</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#a52a2a"><b>insert</b></font>&nbsp;<font color="#6a5acd">into</font>&nbsp;mytable&nbsp;<font color="#6a5acd">values</font>&nbsp;(in1,in2,in3);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;suspend;<br>
<font color="#6a5acd">end</font>;<br>
</font>
</blockquote>

<p>To execute the stored procedure from an SQL Relay program, use code like the
following.</p>

<blockquote>


<font face="monospace">
SQLRelayCommand sqlrcom = (SQLRelayComand)sqlrcon.CreateCommand();<br>
sqlrcom.CommandText =&nbsp;<font color="#ff00ff">&quot;execute procedure testproc ?, ?, ?&quot;</font>;<br>
sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;1&quot;</font>,<font color="#ff00ff">1</font>);<br>
sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;2&quot;</font>,<font color="#ff00ff">1.1</font>);<br>
sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;3&quot;</font>,<font color="#ff00ff">&quot;hello&quot;</font>);<br>
sqlrcom.ExecuteNonQuery();<br>
</font>
</blockquote>

<p>To drop the stored procedure, run a query like the following.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>drop</b></font>&nbsp;<font color="#6a5acd">procedure</font>&nbsp;testproc<br>
</font>
</blockquote>

<span class="heading4">DB2</span><br>

<p>To create the stored procedure, run a query like the following.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>create</b></font>&nbsp;<font color="#6a5acd">procedure</font>&nbsp;testproc(<font color="#a52a2a"><b>in</b></font>&nbsp;in1 int,&nbsp;<font color="#a52a2a"><b>in</b></font>&nbsp;in2 double,&nbsp;<font color="#a52a2a"><b>in</b></font>&nbsp;in3&nbsp;<font color="#2e8b57"><b>varchar</b></font>(<font color="#ff00ff">20</font>)) language sql<br>
<font color="#6a5acd">begin</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#a52a2a"><b>insert</b></font>&nbsp;<font color="#6a5acd">into</font>&nbsp;mytable&nbsp;<font color="#6a5acd">values</font>&nbsp;(in1,in2,in3);<br>
<font color="#6a5acd">end</font>;<br>
</font>
</blockquote>

<p>To execute the stored procedure from an SQL Relay program, use code like the
following.</p>

<blockquote>


<font face="monospace">
SQLRelayCommand sqlrcom = (SQLRelayComand)sqlrcon.CreateCommand();<br>
sqlrcom.CommandText =&nbsp;<font color="#ff00ff">&quot;call testproc(?,?,?)&quot;</font>;<br>
sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;1&quot;</font>,<font color="#ff00ff">1</font>);<br>
sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;2&quot;</font>,<font color="#ff00ff">1.1</font>);<br>
sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;3&quot;</font>,<font color="#ff00ff">&quot;hello&quot;</font>);<br>
sqlrcom.ExecuteNonQuery();<br>
</font>
</blockquote>

<p>To drop the stored procedure, run a query like the following.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>drop</b></font>&nbsp;<font color="#6a5acd">procedure</font>&nbsp;testproc<br>
</font>
</blockquote>

<span class="heading4">Postgresql</span><br>

<p>To create the stored procedure, run a query like the following.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>create</b></font>&nbsp;<font color="#6a5acd">function</font>&nbsp;testfunc(int,<font color="#2e8b57"><b>float</b></font>,<font color="#2e8b57"><b>varchar</b></font>(<font color="#ff00ff">20</font>)) returns void&nbsp;<font color="#6a5acd">as</font>&nbsp;<font color="#ff00ff">'</font><br>
<font color="#ff00ff">begin</font><br>
<font color="#ff00ff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;insert into mytable values ($1,$2,$3);</font><br>
<font color="#ff00ff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</font><br>
<font color="#ff00ff">end;'</font>&nbsp;language plpgsql<br>
</font>
</blockquote>

<p>To execute the stored procedure from an SQL Relay program, use code like the
following.</p>

<blockquote>


<font face="monospace">
SQLRelayCommand sqlrcom = (SQLRelayComand)sqlrcon.CreateCommand();<br>
sqlrcom.CommandText =&nbsp;<font color="#ff00ff">&quot;call testfunc($1,$2,$3)&quot;</font>;<br>
sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;1&quot;</font>,<font color="#ff00ff">1</font>);<br>
sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;2&quot;</font>,<font color="#ff00ff">1.1</font>);<br>
sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;3&quot;</font>,<font color="#ff00ff">&quot;hello&quot;</font>);<br>
sqlrcom.ExecuteNonQuery();<br>
</font>
</blockquote>

<p>To drop the stored procedure, run a query like the following.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>drop</b></font>&nbsp;<font color="#6a5acd">function</font>&nbsp;testfunc(int,<font color="#2e8b57"><b>float</b></font>,<font color="#2e8b57"><b>varchar</b></font>(<font color="#ff00ff">20</font>))<br>
</font>
</blockquote>

<span class="heading4">MySQL</span><br>

<p>To create the stored procedure, run a query like the following.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>create</b></font>&nbsp;<font color="#6a5acd">procedure</font>&nbsp;testproc(<font color="#a52a2a"><b>in</b></font>&nbsp;in1 int,&nbsp;<font color="#a52a2a"><b>in</b></font>&nbsp;in2&nbsp;<font color="#2e8b57"><b>float</b></font>,&nbsp;<font color="#a52a2a"><b>in</b></font>&nbsp;in3&nbsp;<font color="#2e8b57"><b>varchar</b></font>(<font color="#ff00ff">20</font>))<br>
<font color="#6a5acd">begin</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#a52a2a"><b>insert</b></font>&nbsp;<font color="#6a5acd">into</font>&nbsp;mytable&nbsp;<font color="#6a5acd">values</font>&nbsp;(in1,in2,in3);<br>
<font color="#6a5acd">end</font>;<br>
</font>
</blockquote>

<p>To execute the stored procedure from an SQL Relay program, use code like the
following.</p>

<blockquote>


<font face="monospace">
SQLRelayCommand sqlrcom = (SQLRelayComand)sqlrcon.CreateCommand();<br>
sqlrcom.CommandText =&nbsp;<font color="#ff00ff">&quot;call testproc(?,?,?)&quot;</font>;<br>
sqlrcom.Parameters.<font color="#6a5acd">Add</font>(<font color="#ff00ff">&quot;1&quot;</font>,<font color="#ff00ff">1</font>);<br>
sqlrcom.Parameters.<font color="#6a5acd">Add</font>(<font color="#ff00ff">&quot;2&quot;</font>,<font color="#ff00ff">1.1</font>);<br>
sqlrcom.Parameters.<font color="#6a5acd">Add</font>(<font color="#ff00ff">&quot;3&quot;</font>,<font color="#ff00ff">&quot;hello&quot;</font>);<br>
sqlrcom.ExecuteNonQuery();<br>
</font>
</blockquote>

<p>Note: Versions of MySQL prior to 5.0 had trouble calling stored procedures using bind variables.  If you are using a version of MySQL prior to 5.0 then SQL relay must fake the bind variables and you must use colon-delimited variables (:1, :2, :3, etc.) in your queries rather than the native-mysql queston marks.</p>

<p>To drop the stored procedure, run a query like the following.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>drop</b></font>&nbsp;<font color="#6a5acd">procedure</font>&nbsp;testproc<br>
</font>
</blockquote>




<br><span class="heading3">Single Values</span><br>

<p>Some stored procedures return single values.  Below are examples,
illustrating how to create, execute and drop this kind of stored procedure for
each database that SQL Relay supports.</p>

<span class="heading4">Oracle</span><br>

<p>In Oracle, stored procedures can return values through output parameters or
as return values of the procedure itself.</p>

<p>Here is an example where the procedure itself returns a value.  Note that
Oracle calls these functions.</p>

<p>To create the stored procedure, run a query like the following.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>create</b></font>&nbsp;<font color="#6a5acd">function</font>&nbsp;testproc(in1&nbsp;<font color="#a52a2a"><b>in</b></font>&nbsp;<font color="#2e8b57"><b>number</b></font>, in2&nbsp;<font color="#a52a2a"><b>in</b></font>&nbsp;<font color="#2e8b57"><b>number</b></font>, in3&nbsp;<font color="#a52a2a"><b>in</b></font>&nbsp;<font color="#2e8b57"><b>varchar2</b></font>) returns&nbsp;<font color="#2e8b57"><b>number</b></font>&nbsp;<font color="#6a5acd">is</font><br>
<font color="#6a5acd">begin</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#6a5acd">return</font>&nbsp;in1;<br>
<font color="#6a5acd">end</font>;<br>
</font>
</blockquote>

<p>To execute the stored procedure from an SQL Relay program, use code like the
following.</p>

<blockquote>


<font face="monospace">
SQLRelayCommand sqlrcom = (SQLRelayComand)sqlrcon.CreateCommand();<br>
sqlrcom.CommandText =&nbsp;<font color="#ff00ff">&quot;select testproc(:in1,:in2,:in3) from dual&quot;</font>;<br>
sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;in1&quot;</font>,<font color="#ff00ff">1</font>);<br>
sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;in2&quot;</font>,<font color="#ff00ff">1.1</font>);<br>
sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;in3&quot;</font>,<font color="#ff00ff">&quot;hello&quot;</font>);<br>
Int64 result=sqlrcom.ExecuteScalar();<br>
</font>
</blockquote>

<p>To drop the stored procedure, run a query like the following.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>drop</b></font>&nbsp;<font color="#6a5acd">procedure</font>&nbsp;testproc<br>
</font>
</blockquote>

<p>Here is an example where the value is returned through an output
parameter.</p>

<p>To create the stored procedure, run a query like the following.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>create</b></font>&nbsp;<font color="#6a5acd">procedure</font>&nbsp;testproc(in1&nbsp;<font color="#a52a2a"><b>in</b></font>&nbsp;<font color="#2e8b57"><b>number</b></font>, in2&nbsp;<font color="#a52a2a"><b>in</b></font>&nbsp;<font color="#2e8b57"><b>number</b></font>, in3&nbsp;<font color="#a52a2a"><b>in</b></font>&nbsp;<font color="#2e8b57"><b>varchar2</b></font>, out1&nbsp;<font color="#a52a2a"><b>out</b></font>&nbsp;<font color="#2e8b57"><b>number</b></font>)&nbsp;<font color="#6a5acd">as</font><br>
<font color="#6a5acd">begin</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out1:=in1;<br>
<font color="#6a5acd">end</font>;<br>
</font>
</blockquote>

<p>To execute the stored procedure from an SQL Relay program, use code like the
following.</p>

<blockquote>


<font face="monospace">
SQLRelayCommand sqlrcom = (SQLRelayComand)sqlrcon.CreateCommand();<br>
sqlrcom.CommandText =&nbsp;<font color="#ff00ff">&quot;begin testproc(:in1,:in2,:in3,:out1); end&quot;</font>;<br>
sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;in1&quot;</font>,<font color="#ff00ff">1</font>);<br>
sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;in2&quot;</font>,<font color="#ff00ff">1.1</font>);<br>
sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;in3&quot;</font>,<font color="#ff00ff">&quot;hello&quot;</font>);<br>
SQLRelayParameter out1 =&nbsp;<font color="#a52a2a"><b>new</b></font>&nbsp;SQLRelayParameter();<br>
out1.ParameterName =&nbsp;<font color="#ff00ff">&quot;out1&quot;</font>;<br>
out1.Direction = ParameterDirection.Output;<br>
out1.DbType = DbType.Int64;<br>
sqlrcom.Parameters.Add(out1);<br>
sqlrcom.ExecuteNonQuery();<br>
Int64 result = Convert.ToInt64(out1.Value);<br>
</font>
</blockquote>

<p>To drop the stored procedure, run a query like the following.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>drop</b></font>&nbsp;<font color="#6a5acd">procedure</font>&nbsp;testproc<br>
</font>
</blockquote>


<span class="heading4">Sybase and Microsoft SQL Server</span><br>

<p>In Sybase and Microsoft SQL Server, stored procedures return values
through output parameters rather than as return values of the procedure
itself.</p>

<p>To create the stored procedure, run a query like the following.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>create</b></font>&nbsp;<font color="#6a5acd">procedure</font>&nbsp;testproc @in1 int, @in2&nbsp;<font color="#2e8b57"><b>float</b></font>, @in3&nbsp;<font color="#2e8b57"><b>varchar</b></font>(<font color="#ff00ff">20</font>), @out1 int output&nbsp;<font color="#6a5acd">as</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#a52a2a"><b>select</b></font>&nbsp;@out1=<font color="#008b8b">convert</font>(<font color="#2e8b57"><b>varchar</b></font>(<font color="#ff00ff">20</font>),@in1)<br>
</font>
</blockquote>

<p>To execute the stored procedure from an SQL Relay program, use code like the
following.</p>

<blockquote>


<font face="monospace">
SQLRelayCommand sqlrcom = (SQLRelayComand)sqlrcon.CreateCommand();<br>
sqlrcom.CommandText =&nbsp;<font color="#ff00ff">&quot;exec testproc&quot;</font>;<br>
sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;in1&quot;</font>,<font color="#ff00ff">1</font>);<br>
sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;in2&quot;</font>,<font color="#ff00ff">1.1</font>);<br>
sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;in3&quot;</font>,<font color="#ff00ff">&quot;hello&quot;</font>);<br>
SQLRelayParameter out1 =&nbsp;<font color="#a52a2a"><b>new</b></font>&nbsp;SQLRelayParameter();<br>
out1.ParameterName =&nbsp;<font color="#ff00ff">&quot;out1&quot;</font>;<br>
out1.Direction = ParameterDirection.Output;<br>
out1.DbType = DbType.Int64;<br>
sqlrcom.Parameters.Add(out1);<br>
sqlrcom.ExecuteNonQuery();<br>
Int64 result = Convert.ToInt64(out1.Value);<br>
</font>
</blockquote>

<p>To drop the stored procedure, run a query like the following.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>drop</b></font>&nbsp;<font color="#6a5acd">procedure</font>&nbsp;testproc<br>
</font>
</blockquote>


<span class="heading4">Firebird</span><br>

<p>To create the stored procedure, run a query like the following.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>create</b></font>&nbsp;<font color="#6a5acd">procedure</font>&nbsp;testproc(in1&nbsp;<font color="#2e8b57"><b>integer</b></font>, in2&nbsp;<font color="#2e8b57"><b>float</b></font>, in3&nbsp;<font color="#2e8b57"><b>varchar</b></font>(<font color="#ff00ff">20</font>)) returns (out1&nbsp;<font color="#2e8b57"><b>integer</b></font>)&nbsp;<font color="#6a5acd">as</font><br>
<font color="#6a5acd">begin</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out1=in1;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;suspend;<br>
<font color="#6a5acd">end</font>;<br>
</font>
</blockquote>

<p>To execute the stored procedure from an SQL Relay program, use code like the
following.</p>

<blockquote>


<font face="monospace">
SQLRelayCommand sqlrcom = (SQLRelayComand)sqlrcon.CreateCommand();<br>
sqlrcom.CommandText =&nbsp;<font color="#ff00ff">&quot;select * from testproc(?,?,?)&quot;</font>;<br>
sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;1&quot;</font>,<font color="#ff00ff">1</font>);<br>
sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;2&quot;</font>,<font color="#ff00ff">1.1</font>);<br>
sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;3&quot;</font>,<font color="#ff00ff">&quot;hello&quot;</font>);<br>
Int64 result = sqlrcom.ExecuteScalar();<br>
</font>
</blockquote>

<p>Alternatively, you can run a query like the following and receive the result
using an output bind variable.  Note that in Firebird, input and
output bind variable indices are distict from one another.  The index of the
output bind variable is 1 rather than 4, even though there were 3 input bind
variables.</p>

<blockquote>
@ado.net-firebird-testproc-1value-output-params.cs.html@
</blockquote>

<p>To drop the stored procedure, run a query like the following.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>drop</b></font>&nbsp;<font color="#6a5acd">procedure</font>&nbsp;testproc<br>
</font>
</blockquote>


<span class="heading4">DB2</span><br>

<p>In DB2, stored procedures return values through output parameters rather
than as return values of the procedure itself.</p>

<p>To create the stored procedure, run a query like the following.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>create</b></font>&nbsp;<font color="#6a5acd">procedure</font>&nbsp;testproc(<font color="#a52a2a"><b>in</b></font>&nbsp;in1 int,&nbsp;<font color="#a52a2a"><b>in</b></font>&nbsp;in2 double,&nbsp;<font color="#a52a2a"><b>in</b></font>&nbsp;in3&nbsp;<font color="#2e8b57"><b>varchar</b></font>(<font color="#ff00ff">20</font>),&nbsp;<font color="#a52a2a"><b>out</b></font>&nbsp;out1 int) language sql<br>
<font color="#6a5acd">begin</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#a52a2a"><b>set</b></font>&nbsp;out1 = in1;<br>
<font color="#6a5acd">end</font><br>
</font>
</blockquote>

<p>To execute the stored procedure from an SQL Relay program, use code like the
following.</p>

<blockquote>


<font face="monospace">
SQLRelayCommand sqlrcom = (SQLRelayComand)sqlrcon.CreateCommand();<br>
sqlrcom.CommandText =&nbsp;<font color="#ff00ff">&quot;call testproc(?,?,?,?)&quot;</font>;<br>
sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;1&quot;</font>,<font color="#ff00ff">1</font>);<br>
sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;2&quot;</font>,<font color="#ff00ff">1.1</font>);<br>
sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;3&quot;</font>,<font color="#ff00ff">&quot;hello&quot;</font>);<br>
SQLRelayParameter out4 =&nbsp;<font color="#a52a2a"><b>new</b></font>&nbsp;SQLRelayParameter();<br>
out4.ParameterName =&nbsp;<font color="#ff00ff">&quot;4&quot;</font>;<br>
out4.Direction = ParameterDirection.Output;<br>
out4.DbType = DbType.Int64;<br>
sqlrcom.Parameters.Add(out4);<br>
sqlrcom.ExecuteNonQuery();<br>
Int64 result = Convert.ToInt64(out4.Value);<br>
</font>
</blockquote>

<p>To drop the stored procedure, run a query like the following.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>drop</b></font>&nbsp;<font color="#6a5acd">procedure</font>&nbsp;testproc<br>
</font>
</blockquote>


<span class="heading4">Postgresql</span><br>

<p>To create the stored procedure, run a query like the following.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>create</b></font>&nbsp;<font color="#6a5acd">function</font>&nbsp;testfunc(int,<font color="#2e8b57"><b>float</b></font>,<font color="#2e8b57"><b>char</b></font>(<font color="#ff00ff">20</font>)) returns int&nbsp;<font color="#6a5acd">as</font>&nbsp;<font color="#ff00ff">'</font><br>
<font color="#ff00ff">declare</font><br>
<font color="#ff00ff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in1 int;</font><br>
<font color="#ff00ff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in2 float;</font><br>
<font color="#ff00ff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in3 char(20);</font><br>
<font color="#ff00ff">begin</font><br>
<font color="#ff00ff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in1:=$1;</font><br>
<font color="#ff00ff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</font><br>
<font color="#ff00ff">end;</font><br>
<font color="#ff00ff">'</font>&nbsp;language plpgsql<br>
</font>
</blockquote>

<p>To execute the stored procedure from an SQL Relay program, use code like the
following.</p>

<blockquote>


<font face="monospace">
SQLRelayCommand sqlrcom = (SQLRelayComand)sqlrcon.CreateCommand();<br>
sqlrcom.CommandText =&nbsp;<font color="#ff00ff">&quot;select * from testfunc($1,$2,$3)&quot;</font>;<br>
sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;1&quot;</font>,<font color="#ff00ff">1</font>);<br>
sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;2&quot;</font>,<font color="#ff00ff">1.1</font>);<br>
sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;3&quot;</font>,<font color="#ff00ff">&quot;hello&quot;</font>);<br>
Int64 result = sqlrcom.ExecuteScalar();<br>
</font>
</blockquote>

<p>To drop the stored procedure, run a query like the following.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>drop</b></font>&nbsp;<font color="#6a5acd">function</font>&nbsp;testfunc(int,<font color="#2e8b57"><b>float</b></font>,<font color="#2e8b57"><b>char</b></font>(<font color="#ff00ff">20</font>))<br>
</font>
</blockquote>

<span class="heading4">MySQL</span><br>

<p>A single value can be returned from a MySQL function.</p>

<p>To create the function, run a query like the following.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>create</b></font>&nbsp;<font color="#6a5acd">function</font>&nbsp;testfunc(<font color="#a52a2a"><b>in</b></font>&nbsp;in1 int,&nbsp;<font color="#a52a2a"><b>in</b></font>&nbsp;in2&nbsp;<font color="#2e8b57"><b>float</b></font>,&nbsp;<font color="#a52a2a"><b>in</b></font>&nbsp;in3&nbsp;<font color="#2e8b57"><b>varchar</b></font>(<font color="#ff00ff">20</font>)) returns int&nbsp;<font color="#6a5acd">return</font>&nbsp;in1;<br>
</font>
</blockquote>

<p>To execute the function from an SQL Relay program, use code like the
following.</p>

<blockquote>


<font face="monospace">
SQLRelayCommand sqlrcom = (SQLRelayComand)sqlrcon.CreateCommand();<br>
sqlrcom.CommandText =&nbsp;<font color="#ff00ff">&quot;select * from testfunc(?,?,?)&quot;</font>;<br>
sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;1&quot;</font>,<font color="#ff00ff">1</font>);<br>
sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;2&quot;</font>,<font color="#ff00ff">1.1</font>);<br>
sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;3&quot;</font>,<font color="#ff00ff">&quot;hello&quot;</font>);<br>
Int64 result = sqlrcom.ExecuteScalar();<br>
</font>
</blockquote>

<p>Note: Versions of MySQL prior to 5.0 had trouble calling stored procedures using bind variables.  If you are using a version of MySQL prior to 5.0 then SQL relay must fake the bind variables and you must use colon-delimited variables (:1, :2, :3, etc.) in your queries rather than the native-mysql queston marks.</p>

<p>To drop the function, run a query like the following.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>drop</b></font>&nbsp;<font color="#6a5acd">procedure</font>&nbsp;testproc<br>
</font>
</blockquote>

<p>A single value can be returned in the result set of a MySQL procedure.</p>

<p>To create the procedure, run a query like the following.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>create</b></font>&nbsp;<font color="#6a5acd">procedure</font>&nbsp;testproc()&nbsp;<font color="#6a5acd">begin</font>&nbsp;<font color="#a52a2a"><b>select</b></font>&nbsp;<font color="#ff00ff">1</font>;&nbsp;<font color="#6a5acd">end</font>;<br>
</font>
</blockquote>

<p>To execute the procedure from an SQL Relay program, use code like the
following.</p>

<blockquote>


<font face="monospace">
SQLRelayCommand sqlrcom = (SQLRelayComand)sqlrcon.CreateCommand();<br>
sqlrcom.CommandText =&nbsp;<font color="#ff00ff">&quot;select testproc()&quot;</font>;<br>
Int64 result = sqlrcom.ExecuteScalar();<br>
</font>
</blockquote>

<p>To drop the procedure, run a query like the following.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>drop</b></font>&nbsp;<font color="#6a5acd">procedure</font>&nbsp;testproc<br>
</font>
</blockquote>

<p>A single value can be returned using the output variable of a MySQL
procedure.</p>

<p>To create the procedure, run a query like the following.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>create</b></font>&nbsp;<font color="#6a5acd">procedure</font>&nbsp;testproc(<font color="#a52a2a"><b>out</b></font>&nbsp;out1 int)&nbsp;<font color="#6a5acd">begin</font>&nbsp;<font color="#a52a2a"><b>select</b></font>&nbsp;<font color="#ff00ff">1</font>&nbsp;<font color="#6a5acd">into</font>&nbsp;out1;&nbsp;<font color="#6a5acd">end</font>;<br>
</font>
</blockquote>

<p>To execute the procedure from an SQL Relay program, use code like the
following.</p>

<blockquote>


<font face="monospace">
SQLRelayCommand sqlrcom = (SQLRelayComand)sqlrcon.CreateCommand();<br>
<br>
sqlrcom.CommandText =&nbsp;<font color="#ff00ff">&quot;set @out1=0&quot;</font>;<br>
Int64 result = sqlrcom.ExecuteNonQuery();<br>
<br>
sqlrcom.CommandText =&nbsp;<font color="#ff00ff">&quot;call testproc(@out1)&quot;</font>;<br>
Int64 result = sqlrcom.ExecuteNonQuery();<br>
<br>
sqlrcom.CommandText =&nbsp;<font color="#ff00ff">&quot;select @out1&quot;</font>;<br>
Int64 result = sqlrcom.ExecuteScalar();<br>
</font>
</blockquote>

<p>To drop the procedure, run a query like the following.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>drop</b></font>&nbsp;<font color="#6a5acd">procedure</font>&nbsp;testproc<br>
</font>
</blockquote>





<br><span class="heading3">Multiple Values</span><br>

<p>Some stored procedures return multiple values.  Below are examples,
illustrating how to create, execute and drop this kind of stored procedure for
each database that SQL Relay supports.</p>

<span class="heading4">Oracle</span><br>

<p>In Oracle, stored procedures can return values through output parameters or
as return values of the procedure itself.  If a procedure needs to return
multiple values, it can return one of them as the return value of the procedure
itself, but the rest must be returned through output parameters.</p>

<p>To create the stored procedure, run a query like the following.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>create</b></font>&nbsp;<font color="#6a5acd">procedure</font>&nbsp;testproc(in1&nbsp;<font color="#a52a2a"><b>in</b></font>&nbsp;<font color="#2e8b57"><b>number</b></font>, in2&nbsp;<font color="#a52a2a"><b>in</b></font>&nbsp;<font color="#2e8b57"><b>number</b></font>, in3&nbsp;<font color="#a52a2a"><b>in</b></font>&nbsp;<font color="#2e8b57"><b>varchar2</b></font>, out1&nbsp;<font color="#a52a2a"><b>out</b></font>&nbsp;<font color="#2e8b57"><b>number</b></font>, out2&nbsp;<font color="#a52a2a"><b>out</b></font>&nbsp;<font color="#2e8b57"><b>number</b></font>, out3&nbsp;<font color="#a52a2a"><b>out</b></font>&nbsp;<font color="#2e8b57"><b>varchar2</b></font>)&nbsp;<font color="#6a5acd">is</font><br>
<font color="#6a5acd">begin</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out1:=in1;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out2:=in2;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out3:=in3;<br>
<font color="#6a5acd">end</font>;<br>
</font>
</blockquote>

<p>To execute the stored procedure from an SQL Relay program, use code like the
following.</p>

<blockquote>


<font face="monospace">
SQLRelayCommand sqlrcom = (SQLRelayComand)sqlrcon.CreateCommand();<br>
sqlrcom.CommandText =&nbsp;<font color="#ff00ff">&quot;begin testproc(:in1,:in2,:in3,:out1,:out2,:out3); end;&quot;</font>;<br>
sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;in1&quot;</font>,<font color="#ff00ff">1</font>);<br>
sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;in2&quot;</font>,<font color="#ff00ff">1.1</font>);<br>
sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;in3&quot;</font>,<font color="#ff00ff">&quot;hello&quot;</font>);<br>
SQLRelayParameter out1 =&nbsp;<font color="#a52a2a"><b>new</b></font>&nbsp;SQLRelayParameter();<br>
out1.ParameterName =&nbsp;<font color="#ff00ff">&quot;out1&quot;</font>;<br>
out1.Direction = ParameterDirection.Output;<br>
out1.DbType = DbType.Int64;<br>
sqlrcom.Parameters.Add(out1);<br>
SQLRelayParameter out2 =&nbsp;<font color="#a52a2a"><b>new</b></font>&nbsp;SQLRelayParameter();<br>
out2.ParameterName =&nbsp;<font color="#ff00ff">&quot;out2&quot;</font>;<br>
out2.Direction = ParameterDirection.Output;<br>
out2.DbType = DbType.Double;<br>
sqlrcom.Parameters.Add(out2);<br>
SQLRelayParameter out2 =&nbsp;<font color="#a52a2a"><b>new</b></font>&nbsp;SQLRelayParameter();<br>
out3.ParameterName =&nbsp;<font color="#ff00ff">&quot;out3&quot;</font>;<br>
out3.Direction = ParameterDirection.Output;<br>
out3.DbType = DbType.String;<br>
out3.Size =&nbsp;<font color="#ff00ff">20</font>;<br>
sqlrcom.Parameters.Add(out3);<br>
sqlrcom.ExecuteNonQuery();<br>
Int64 result1 = Convert.ToInt64(out1.Value);<br>
Double result2 = Convert.ToDouble(out2.Value);<br>
String result3 = Convert.ToString(out3.Value);<br>
</font>
</blockquote>

<p>To drop the stored procedure, run a query like the following.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>drop</b></font>&nbsp;<font color="#6a5acd">procedure</font>&nbsp;testproc<br>
</font>
</blockquote>


<span class="heading4">Sybase and Microsoft SQL Server</span><br>

<p>To create the stored procedure, run a query like the following.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>create</b></font>&nbsp;<font color="#6a5acd">procedure</font>&nbsp;testproc @in1 int, @in2&nbsp;<font color="#2e8b57"><b>float</b></font>, @in3&nbsp;<font color="#2e8b57"><b>varchar</b></font>(<font color="#ff00ff">20</font>), @out1 int output, @out2 int output, @out3 int output&nbsp;<font color="#6a5acd">as</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#a52a2a"><b>select</b></font>&nbsp;@out1=<font color="#008b8b">convert</font>(<font color="#2e8b57"><b>varchar</b></font>(<font color="#ff00ff">20</font>),@in1),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@out2=<font color="#008b8b">convert</font>(<font color="#2e8b57"><b>varchar</b></font>(<font color="#ff00ff">20</font>),@in2),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@out2=<font color="#008b8b">convert</font>(<font color="#2e8b57"><b>varchar</b></font>(<font color="#ff00ff">20</font>),@in2)<br>
</font>
</blockquote>

<p>To execute the stored procedure from an SQL Relay program, use code like the
following.</p>

<blockquote>


<font face="monospace">
SQLRelayCommand sqlrcom = (SQLRelayComand)sqlrcon.CreateCommand();<br>
sqlrcom.CommandText =&nbsp;<font color="#ff00ff">&quot;exec testproc&quot;</font>;<br>
sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;in1&quot;</font>,<font color="#ff00ff">1</font>);<br>
sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;in2&quot;</font>,<font color="#ff00ff">1.1</font>);<br>
sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;in3&quot;</font>,<font color="#ff00ff">&quot;hello&quot;</font>);<br>
SQLRelayParameter out1 =&nbsp;<font color="#a52a2a"><b>new</b></font>&nbsp;SQLRelayParameter();<br>
out1.ParameterName =&nbsp;<font color="#ff00ff">&quot;out1&quot;</font>;<br>
out1.Direction = ParameterDirection.Output;<br>
out1.DbType = DbType.Int64;<br>
sqlrcom.Parameters.Add(out1);<br>
SQLRelayParameter out2 =&nbsp;<font color="#a52a2a"><b>new</b></font>&nbsp;SQLRelayParameter();<br>
out2.ParameterName =&nbsp;<font color="#ff00ff">&quot;out2&quot;</font>;<br>
out2.Direction = ParameterDirection.Output;<br>
out2.DbType = DbType.Double;<br>
sqlrcom.Parameters.Add(out2);<br>
SQLRelayParameter out2 =&nbsp;<font color="#a52a2a"><b>new</b></font>&nbsp;SQLRelayParameter();<br>
out3.ParameterName =&nbsp;<font color="#ff00ff">&quot;out3&quot;</font>;<br>
out3.Direction = ParameterDirection.Output;<br>
out3.DbType = DbType.String;<br>
out3.Size =&nbsp;<font color="#ff00ff">20</font>;<br>
sqlrcom.Parameters.Add(out3);<br>
sqlrcom.ExecuteNonQuery();<br>
Int64 result1 = Convert.ToInt64(out1.Value);<br>
Double result2 = Convert.ToDouble(out2.Value);<br>
String result3 = Convert.ToString(out3.Value);<br>
</font>
</blockquote>

<p>To drop the stored procedure, run a query like the following.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>drop</b></font>&nbsp;<font color="#6a5acd">procedure</font>&nbsp;testproc<br>
</font>
</blockquote>


<span class="heading4">Firebird</span><br>

<p>To create the stored procedure, run a query like the following.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>create</b></font>&nbsp;<font color="#6a5acd">procedure</font>&nbsp;testproc(in1&nbsp;<font color="#2e8b57"><b>integer</b></font>, in2&nbsp;<font color="#2e8b57"><b>float</b></font>, in3&nbsp;<font color="#2e8b57"><b>varchar</b></font>(<font color="#ff00ff">20</font>)) returns (out1&nbsp;<font color="#2e8b57"><b>integer</b></font>, out2&nbsp;<font color="#2e8b57"><b>float</b></font>, out3&nbsp;<font color="#2e8b57"><b>varchar</b></font>(<font color="#ff00ff">20</font>))&nbsp;<font color="#6a5acd">as</font><br>
<font color="#6a5acd">begin</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out1=in1;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out2=in2;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out3=in3;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;suspend;<br>
<font color="#6a5acd">end</font>;<br>
</font>
</blockquote>

<p>To execute the stored procedure from an SQL Relay program, use code like the
following.</p>

<blockquote>


<font face="monospace">
SQLRelayCommand sqlrcom = (SQLRelayComand)sqlrcon.CreateCommand();<br>
sqlrcom.CommandText =&nbsp;<font color="#ff00ff">&quot;select * from testproc(?,?,?)&quot;</font>;<br>
sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;1&quot;</font>,<font color="#ff00ff">1</font>);<br>
sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;2&quot;</font>,<font color="#ff00ff">1.1</font>);<br>
sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;3&quot;</font>,<font color="#ff00ff">&quot;hello&quot;</font>);<br>
sqlrcom.ExecuteReader();<br>
System.Data.IDataReader datareader = sqlrcom.ExecuteReader();<br>
datareader.Read();<br>
Int64 out1 = datareader.GetInt64(<font color="#ff00ff">0</font>);<br>
Double out2 = datareader.GetDouble(<font color="#ff00ff">1</font>);<br>
String out3 = datareader.GetString(<font color="#ff00ff">2</font>);<br>
</font>
</blockquote>

<p>Alternatively, you can run a query like the following and receive the result
using a output bind variables.  Note that in Firebird, input and
output bind variable indices are distict from one another.  The index of the
first output bind variable is 1 rather than 4, even though there were 3 input
bind variables.</p>

<blockquote>


<font face="monospace">
SQLRelayCommand sqlrcom = (SQLRelayComand)sqlrcon.CreateCommand();<br>
sqlrcom.CommandText =&nbsp;<font color="#ff00ff">&quot;exec procedure testproc ?, ?, ?&quot;</font>;<br>
sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;1&quot;</font>,<font color="#ff00ff">1</font>);<br>
sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;2&quot;</font>,<font color="#ff00ff">1.1</font>);<br>
sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;3&quot;</font>,<font color="#ff00ff">&quot;hello&quot;</font>);<br>
SQLRelayParameter out1 =&nbsp;<font color="#a52a2a"><b>new</b></font>&nbsp;SQLRelayParameter();<br>
out1.ParameterName =&nbsp;<font color="#ff00ff">&quot;1&quot;</font>;<br>
out1.Direction = ParameterDirection.Output;<br>
out1.DbType = DbType.Int64;<br>
sqlrcom.Parameters.Add(out1);<br>
SQLRelayParameter out2 =&nbsp;<font color="#a52a2a"><b>new</b></font>&nbsp;SQLRelayParameter();<br>
out2.ParameterName =&nbsp;<font color="#ff00ff">&quot;2&quot;</font>;<br>
out2.Direction = ParameterDirection.Output;<br>
out2.DbType = DbType.Double;<br>
sqlrcom.Parameters.Add(out2);<br>
SQLRelayParameter out2 =&nbsp;<font color="#a52a2a"><b>new</b></font>&nbsp;SQLRelayParameter();<br>
out3.ParameterName =&nbsp;<font color="#ff00ff">&quot;3&quot;</font>;<br>
out3.Direction = ParameterDirection.Output;<br>
out3.DbType = DbType.String;<br>
out3.Size =&nbsp;<font color="#ff00ff">20</font>;<br>
sqlrcom.Parameters.Add(out3);<br>
sqlrcom.ExecuteNonQuery();<br>
Int64 result1 = Convert.ToInt64(out1.Value);<br>
Double result2 = Convert.ToDouble(out2.Value);<br>
String result3 = Convert.ToString(out3.Value);<br>
</font>
</blockquote>

<p>To drop the stored procedure, run a query like the following.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>drop</b></font>&nbsp;<font color="#6a5acd">procedure</font>&nbsp;testproc<br>
</font>
</blockquote>


<span class="heading4">DB2</span><br>

<p>To create the stored procedure, run a query like the following.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>create</b></font>&nbsp;<font color="#6a5acd">procedure</font>&nbsp;testproc(<font color="#a52a2a"><b>in</b></font>&nbsp;in1 int,&nbsp;<font color="#a52a2a"><b>in</b></font>&nbsp;in2 double,&nbsp;<font color="#a52a2a"><b>in</b></font>&nbsp;in3&nbsp;<font color="#2e8b57"><b>varchar</b></font>(<font color="#ff00ff">20</font>),&nbsp;<font color="#a52a2a"><b>out</b></font>&nbsp;out1 int,&nbsp;<font color="#a52a2a"><b>out</b></font>&nbsp;out2 double,&nbsp;<font color="#a52a2a"><b>out</b></font>&nbsp;out3&nbsp;<font color="#2e8b57"><b>varchar</b></font>(<font color="#ff00ff">20</font>)) language sql<br>
<font color="#6a5acd">begin</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#a52a2a"><b>set</b></font>&nbsp;out1 = in1;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#a52a2a"><b>set</b></font>&nbsp;out2 = in2;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#a52a2a"><b>set</b></font>&nbsp;out3 = in3;<br>
<font color="#6a5acd">end</font><br>
</font>
</blockquote>

<p>To execute the stored procedure from an SQL Relay program, use code like the
following.</p>

<blockquote>


<font face="monospace">
SQLRelayCommand sqlrcom = (SQLRelayComand)sqlrcon.CreateCommand();<br>
sqlrcom.CommandText =&nbsp;<font color="#ff00ff">&quot;call testproc(?,?,?,?,?,?)&quot;</font>;<br>
sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;1&quot;</font>,<font color="#ff00ff">1</font>);<br>
sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;2&quot;</font>,<font color="#ff00ff">1.1</font>);<br>
sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;3&quot;</font>,<font color="#ff00ff">&quot;hello&quot;</font>);<br>
SQLRelayParameter out1 =&nbsp;<font color="#a52a2a"><b>new</b></font>&nbsp;SQLRelayParameter();<br>
out1.ParameterName =&nbsp;<font color="#ff00ff">&quot;4&quot;</font>;<br>
out1.Direction = ParameterDirection.Output;<br>
out1.DbType = DbType.Int64;<br>
sqlrcom.Parameters.Add(out1);<br>
SQLRelayParameter out2 =&nbsp;<font color="#a52a2a"><b>new</b></font>&nbsp;SQLRelayParameter();<br>
out2.ParameterName =&nbsp;<font color="#ff00ff">&quot;5&quot;</font>;<br>
out2.Direction = ParameterDirection.Output;<br>
out2.DbType = DbType.Double;<br>
sqlrcom.Parameters.Add(out2);<br>
SQLRelayParameter out2 =&nbsp;<font color="#a52a2a"><b>new</b></font>&nbsp;SQLRelayParameter();<br>
out3.ParameterName =&nbsp;<font color="#ff00ff">&quot;6&quot;</font>;<br>
out3.Direction = ParameterDirection.Output;<br>
out3.DbType = DbType.String;<br>
out3.Size =&nbsp;<font color="#ff00ff">20</font>;<br>
sqlrcom.Parameters.Add(out3);<br>
sqlrcom.ExecuteNonQuery();<br>
Int64 result1 = Convert.ToInt64(out1.Value);<br>
Double result2 = Convert.ToDouble(out2.Value);<br>
String result3 = Convert.ToString(out3.Value);<br>
</font>
</blockquote>

<p>To drop the stored procedure, run a query like the following.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>drop</b></font>&nbsp;<font color="#6a5acd">procedure</font>&nbsp;testproc<br>
</font>
</blockquote>


<span class="heading4">Postgresql</span><br>

<p>To create the stored procedure, run a query like the following.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>create</b></font>&nbsp;<font color="#6a5acd">function</font>&nbsp;testfunc(int,<font color="#2e8b57"><b>float</b></font>,<font color="#2e8b57"><b>char</b></font>(<font color="#ff00ff">20</font>)) returns record&nbsp;<font color="#6a5acd">as</font>&nbsp;<font color="#ff00ff">'</font><br>
<font color="#ff00ff">declare</font><br>
<font color="#ff00ff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output record;</font><br>
<font color="#ff00ff">begin</font><br>
<font color="#ff00ff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select $1,$2,$3 into output;</font><br>
<font color="#ff00ff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return output;</font><br>
<font color="#ff00ff">end;</font><br>
<font color="#ff00ff">'</font>&nbsp;language plpgsql<br>
</font>
</blockquote>

<p>To execute the stored procedure from an SQL Relay program, use code like the
following.</p>

<blockquote>


<font face="monospace">
SQLRelayCommand sqlrcom = (SQLRelayComand)sqlrcon.CreateCommand();<br>
sqlrcom.CommandText =&nbsp;<font color="#ff00ff">&quot;select * from testfunc(?,?,?) as (col1 int, col2 float, col3 char(20))&quot;</font>;<br>
sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;in1&quot;</font>,<font color="#ff00ff">1</font>);<br>
sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;in2&quot;</font>,<font color="#ff00ff">1.1</font>);<br>
sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;in3&quot;</font>,<font color="#ff00ff">&quot;hello&quot;</font>);<br>
sqlrcom.ExecuteReader();<br>
System.Data.IDataReader datareader = sqlrcom.ExecuteReader();<br>
datareader.Read();<br>
Int64 out1 = datareader.GetInt64(<font color="#ff00ff">0</font>);<br>
Double out2 = datareader.GetDouble(<font color="#ff00ff">1</font>);<br>
String out3 = datareader.GetString(<font color="#ff00ff">2</font>);<br>
</font>
</blockquote>

<p>To drop the stored procedure, run a query like the following.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>drop</b></font>&nbsp;<font color="#6a5acd">function</font>&nbsp;testfunc(int,<font color="#2e8b57"><b>float</b></font>,<font color="#2e8b57"><b>char</b></font>(<font color="#ff00ff">20</font>))<br>
</font>
</blockquote>

<span class="heading4">MySQL</span><br>

<p>Here's how you can get multiple values from the result
set of a MySQL procedure.</p>

<p>To create the stored procedure, run a query like the following.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>create</b></font>&nbsp;<font color="#6a5acd">procedure</font>&nbsp;testproc(<font color="#a52a2a"><b>in</b></font>&nbsp;in1 int,&nbsp;<font color="#a52a2a"><b>in</b></font>&nbsp;in2&nbsp;<font color="#2e8b57"><b>float</b></font>,&nbsp;<font color="#a52a2a"><b>in</b></font>&nbsp;in3&nbsp;<font color="#2e8b57"><b>varchar</b></font>(<font color="#ff00ff">20</font>))&nbsp;<font color="#6a5acd">begin</font>&nbsp;<font color="#a52a2a"><b>select</b></font>&nbsp;in1, in2, in3;&nbsp;<font color="#6a5acd">end</font>;<br>
</font>
</blockquote>

<p>To execute the stored procedure from an SQL Relay program, use code like the
following.</p>

<blockquote>


<font face="monospace">
SQLRelayCommand sqlrcom = (SQLRelayComand)sqlrcon.CreateCommand();<br>
sqlrcom.CommandText =&nbsp;<font color="#ff00ff">&quot;call testproc(?,?,?)&quot;</font>;<br>
sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;1&quot;</font>,<font color="#ff00ff">1</font>);<br>
sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;2&quot;</font>,<font color="#ff00ff">1.1</font>);<br>
sqlrcom.Parameters.Add(<font color="#ff00ff">&quot;3&quot;</font>,<font color="#ff00ff">&quot;hello&quot;</font>);<br>
sqlrcom.ExecuteReader();<br>
System.Data.IDataReader datareader = sqlrcom.ExecuteReader();<br>
datareader.Read();<br>
Int64 out1 = datareader.GetInt64(<font color="#ff00ff">0</font>);<br>
Double out2 = datareader.GetDouble(<font color="#ff00ff">1</font>);<br>
String out3 = datareader.GetString(<font color="#ff00ff">2</font>);<br>
</font>
</blockquote>

<p>Note: Versions of MySQL prior to 5.0 had trouble calling stored procedures using bind variables.  If you are using a version of MySQL prior to 5.0 then SQL relay must fake the bind variables and you must use colon-delimited variables (:1, :2, :3, etc.) in your queries rather than the native-mysql queston marks.</p>

<p>To drop the stored procedure, run a query like the following.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>drop</b></font>&nbsp;<font color="#6a5acd">procedure</font>&nbsp;testproc<br>
</font>
</blockquote>

<p>Here's how you can get multiple values from the output variables
of a MySQL procedure.</p>

<p>To create the stored procedure, run a query like the following.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>create</b></font>&nbsp;<font color="#6a5acd">procedure</font>&nbsp;testproc(<font color="#a52a2a"><b>out</b></font>&nbsp;out1 int,&nbsp;<font color="#a52a2a"><b>out</b></font>&nbsp;out2&nbsp;<font color="#2e8b57"><b>float</b></font>,&nbsp;<font color="#a52a2a"><b>out</b></font>&nbsp;out3&nbsp;<font color="#2e8b57"><b>varchar</b></font>(<font color="#ff00ff">20</font>))&nbsp;<font color="#6a5acd">begin</font>&nbsp;<font color="#a52a2a"><b>select</b></font>&nbsp;<font color="#ff00ff">1</font>,<font color="#ff00ff">1.1</font>,<font color="#ff00ff">'hello'</font>&nbsp;<font color="#6a5acd">into</font>&nbsp;out1, out2, out3;&nbsp;<font color="#6a5acd">end</font>;<br>
</font>
</blockquote>

<p>To execute the stored procedure from an SQL Relay program, use code like the
following.</p>

<blockquote>


<font face="monospace">
SQLRelayCommand sqlrcom = (SQLRelayComand)sqlrcon.CreateCommand();<br>
<br>
sqlrcom.CommandText =&nbsp;<font color="#ff00ff">&quot;set @out1=0, @out2=0.0, @out3=''&quot;</font>;<br>
Int64 result = sqlrcom.ExecuteNonQuery();<br>
<br>
sqlrcom.CommandText =&nbsp;<font color="#ff00ff">&quot;call testproc(@out1,@out2,@out3)&quot;</font>;<br>
Int64 result = sqlrcom.ExecuteNonQuery();<br>
<br>
sqlrcom.CommandText =&nbsp;<font color="#ff00ff">&quot;select @out1,@out2,@out3&quot;</font>;<br>
System.Data.IDataReader datareader = sqlrcom.ExecuteReader();<br>
datareader.Read();<br>
Int64 out1 = datareader.GetInt64(<font color="#ff00ff">0</font>);<br>
Double out2 = datareader.GetDouble(<font color="#ff00ff">1</font>);<br>
String out3 = datareader.GetString(<font color="#ff00ff">2</font>);<br>
</font>
</blockquote>

<p>To drop the stored procedure, run a query like the following.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>drop</b></font>&nbsp;<font color="#6a5acd">procedure</font>&nbsp;testproc<br>
</font>
</blockquote>



<br><span class="heading3">Result Sets</span><br>

<p>Some stored procedures return entire result sets.  Below are examples,
illustrating how to create, execute and drop this kind of stored procedure for
each database that SQL Relay supports.</p>

<span class="heading4">Oracle</span><br>

<p>To create the stored procedure, run a query like the following.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>create</b></font>&nbsp;<font color="#a52a2a"><b>or</b></font>&nbsp;<font color="#008b8b">replace</font>&nbsp;package types&nbsp;<font color="#6a5acd">as</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#6a5acd">type</font>&nbsp;cursorType&nbsp;<font color="#6a5acd">is</font>&nbsp;ref&nbsp;<font color="#6a5acd">cursor</font>;<br>
<font color="#6a5acd">end</font>;<br>
<br>
<font color="#a52a2a"><b>create</b></font>&nbsp;<font color="#6a5acd">function</font>&nbsp;testproc&nbsp;<font color="#6a5acd">return</font>&nbsp;types.cursortype&nbsp;<font color="#6a5acd">is</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l_cursor&nbsp;&nbsp;&nbsp;&nbsp;types.cursorType;<br>
<font color="#6a5acd">begin</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;open l_cursor&nbsp;<font color="#6a5acd">for</font>&nbsp;select *&nbsp;<font color="#6a5acd">from</font>&nbsp;mytable;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#6a5acd">return</font>&nbsp;l_cursor;<br>
<font color="#6a5acd">end</font>;<br>
</font>
</blockquote>

<p>In Oracle, for a result set to be fetched from a stored procedure, the result set must be bound to an output parameter of type cursor.  That cursor may then be opened and fetched from.  In fact, a stored procedure may return multiple result sets and each may be bound to a cursor.</p>

<p>ADO.NET abstracts this with the "multiple result sets" paradigm.  Output cursors must be defined when the query is executed.  Once the main query has been executed, NextResult may be called to step through the result sets bound to each cursor.</p>

<p>For example:</p>

<blockquote>


<font face="monospace">
SQLRelayCommand sqlrcom = (SQLRelayComand)sqlrcon.CreateCommand();<br>
sqlrcom.CommandText =&nbsp;<font color="#ff00ff">&quot;begin :curs=testproc; end;&quot;</font>;<br>
<br>
SQLRelayParameter curs =&nbsp;<font color="#a52a2a"><b>new</b></font>&nbsp;SQLRelayParameter();<br>
curs.ParameterName =&nbsp;<font color="#ff00ff">&quot;curs&quot;</font>;<br>
curs.Direction = ParameterDirection.Output;<br>
curs.SQLRelayType = SQLRelayType.Cursor;<br>
sqlrcom.Parameters.Add(curs);<br>
<br>
System.Data.IDataReader datareader = sqlrcom.ExecuteReader();<br>
<br>
<font color="#0000ff">// the main result set will be empty, skip to the result set of the cursor</font><br>
datareader.NextResult();<br>
<br>
datareader.Read();<br>
Int64 out1 = datareader.GetInt64(<font color="#ff00ff">0</font>);<br>
Double out2 = datareader.GetDouble(<font color="#ff00ff">1</font>);<br>
String out3 = datareader.GetString(<font color="#ff00ff">2</font>);<br>
</font>
</blockquote>

<p>Note that in the above code, the Parameter.SQLRelayType must be set rather than Parameter.DbType, which would generally be set.  DbType is constrained to a set of values defined in the ADO.NET spec, which does not include Cursor types.</p>

<p>This approach has some drawbacks though.  Mainly, if a stored procedure returns multiple results sets then they must be accessed sequentially.  The SQL Relay ADO.NET adapter provides another way of accessing the result sets of a stored procedure.  After execution, the Value of each cursor parameter may be cast to a SQLRelayDataReader and data may be fetched from it.  This approach allows data to be fetched from any result set, in any order.</p>

<p>For example:</p>

<blockquote>


<font face="monospace">
SQLRelayCommand sqlrcom = (SQLRelayComand)sqlrcon.CreateCommand();<br>
sqlrcom.CommandText =&nbsp;<font color="#ff00ff">&quot;begin :curs=testproc; end;&quot;</font>;<br>
<br>
SQLRelayParameter curs =&nbsp;<font color="#a52a2a"><b>new</b></font>&nbsp;SQLRelayParameter();<br>
curs.ParameterName =&nbsp;<font color="#ff00ff">&quot;curs&quot;</font>;<br>
curs.Direction = ParameterDirection.Output;<br>
curs.SQLRelayType = SQLRelayType.Cursor;<br>
sqlrcom.Parameters.Add(curs);<br>
<br>
sqlrcom.ExecuteNonQuery();<br>
<br>
SQLRelayDataReader datareader = (SQLRelayDataReader)curs.Value;<br>
<br>
datareader.Read();<br>
Int64 out1 = datareader.GetInt64(<font color="#ff00ff">0</font>);<br>
Double out2 = datareader.GetDouble(<font color="#ff00ff">1</font>);<br>
String out3 = datareader.GetString(<font color="#ff00ff">2</font>);<br>
</font>
</blockquote>

<p>To drop the stored procedure, run a query like the following.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>drop</b></font>&nbsp;<font color="#6a5acd">function</font>&nbsp;testproc<br>
<font color="#a52a2a"><b>drop</b></font>&nbsp;package types<br>
</font>
</blockquote>

<span class="heading4">Sybase and Microsoft SQL Server</span><br>

<p>To create the stored procedure, run a query like the following.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>create</b></font>&nbsp;<font color="#6a5acd">procedure</font>&nbsp;testproc&nbsp;<font color="#6a5acd">as</font>&nbsp;<font color="#a52a2a"><b>select</b></font>&nbsp;*&nbsp;<font color="#6a5acd">from</font>&nbsp;testtable<br>
</font>
</blockquote>

<p>To exceute the stored procedure from an SQL Relay program, ue code like the
following.</p>

<blockquote>


<font face="monospace">
sqlrcom.CommandText =&nbsp;<font color="#ff00ff">&quot;exec testproc&quot;</font>;<br>
System.Data.IDataReader datareader = sqlrcom.ExecuteReader();<br>
datareader.Read();<br>
Int64 out1 = datareader.GetInt64(<font color="#ff00ff">0</font>);<br>
Double out2 = datareader.GetDouble(<font color="#ff00ff">1</font>);<br>
String out3 = datareader.GetString(<font color="#ff00ff">2</font>);<br>
datareader.Read();<br>
out1 = datareader.GetInt64(<font color="#ff00ff">0</font>);<br>
out2 = datareader.GetDouble(<font color="#ff00ff">1</font>);<br>
out3 = datareader.GetString(<font color="#ff00ff">2</font>);<br>
</font>
</blockquote>

<p>To drop the stored procedure, run a query like the following.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>drop</b></font>&nbsp;<font color="#6a5acd">procedure</font>&nbsp;testproc<br>
</font>
</blockquote>


<span class="heading4">Firebird</span><br>

<p>Stored procedures in Firebird can return a result set if a
select query in the procedure selects values into the output parameters and
then issues a suspend command, however SQL Relay doesn't currently support
stored procedures that return result sets.</p>

<span class="heading4">DB2</span><br>

<p>Stored procedures in DB2 can return a result set if the procedure is declared
to return one, however SQL Relay doesn't currently support stored procedures
that return result sets.</p>

<span class="heading4">Postgresql</span><br>

<p>To create the stored procedure, run a query like the following.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>create</b></font>&nbsp;<font color="#6a5acd">function</font>&nbsp;testfunc() returns setof record&nbsp;<font color="#6a5acd">as</font>&nbsp;<font color="#ff00ff">'</font><br>
<font color="#ff00ff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;declare output record;</font><br>
<font color="#ff00ff">begin</font><br>
<font color="#ff00ff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for output in select * from mytable loop</font><br>
<font color="#ff00ff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return next output;</font><br>
<font color="#ff00ff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end loop;</font><br>
<font color="#ff00ff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</font><br>
<font color="#ff00ff">end;</font><br>
<font color="#ff00ff">'</font>&nbsp;language plpgsql<br>
</font>
</blockquote>

<p>To execute the stored procedure from an SQL Relay program, use code like the
following.</p>

<blockquote>


<font face="monospace">
sqlrcom.CommandText =&nbsp;<font color="#ff00ff">&quot;select * from testfunc() as (testint int, testfloat float, testchar char(40))&quot;</font>;<br>
System.Data.IDataReader datareader = sqlrcom.ExecuteReader();<br>
datareader.Read();<br>
Int64 out1 = datareader.GetInt64(<font color="#ff00ff">0</font>);<br>
Double out2 = datareader.GetDouble(<font color="#ff00ff">1</font>);<br>
String out3 = datareader.GetString(<font color="#ff00ff">2</font>);<br>
datareader.Read();<br>
out1 = datareader.GetInt64(<font color="#ff00ff">0</font>);<br>
out2 = datareader.GetDouble(<font color="#ff00ff">1</font>);<br>
out3 = datareader.GetString(<font color="#ff00ff">2</font>);<br>
</font>
</blockquote>

<p>To drop the stored procedure, run a query like the following.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>drop</b></font>&nbsp;<font color="#6a5acd">function</font>&nbsp;testfunc<br>
</font>
</blockquote>

<span class="heading4">MySQL</span><br>

<p>The result sets of all select statements called within MySQL stored
procedures (that aren't selected into variables) are returned from the procedure
call.  Though MySQL stored procedures can return multiple result sets,
currently SQL Relay can only fetch the first result set.</p>

<p>To create the stored procedure which returns a result set, run a query like
the following.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>create</b></font>&nbsp;<font color="#6a5acd">procedure</font>&nbsp;testproc()&nbsp;<font color="#6a5acd">begin</font>&nbsp;<font color="#a52a2a"><b>select</b></font>&nbsp;*&nbsp;<font color="#6a5acd">from</font>&nbsp;mytable;&nbsp;<font color="#6a5acd">end</font>;<br>
</font>
</blockquote>

<p>To execute the stored procedure from an SQL Relay program, use code like the
following.</p>

<blockquote>


<font face="monospace">
sqlrcom.CommandText =&nbsp;<font color="#ff00ff">&quot;call testproc()&quot;</font>;<br>
System.Data.IDataReader datareader = sqlrcom.ExecuteReader();<br>
datareader.Read();<br>
Int64 out1 = datareader.GetInt64(<font color="#ff00ff">0</font>);<br>
Double out2 = datareader.GetDouble(<font color="#ff00ff">1</font>);<br>
String out3 = datareader.GetString(<font color="#ff00ff">2</font>);<br>
datareader.Read();<br>
out1 = datareader.GetInt64(<font color="#ff00ff">0</font>);<br>
out2 = datareader.GetDouble(<font color="#ff00ff">1</font>);<br>
out3 = datareader.GetString(<font color="#ff00ff">2</font>);<br>
</font>
</blockquote>

<p>To drop the stored procedure, run a query like the following.</p>

<blockquote>


<font face="monospace">
<font color="#a52a2a"><b>drop</b></font>&nbsp;<font color="#6a5acd">procedure</font>&nbsp;testproc<br>
</font>
</blockquote>

<a name="lastinsertid"></a>
<span class="heading2">Getting the Last Insert ID</span><br><br>

<p>Databases with autoincrement or identity columns often provide functions which return the "last insert id"; the value of the autoincrement column that was generated during the insert into the database.</p>

<p>Unfortunately ADO.NET doesn't expose a generic method for getting the last insert id, but when using the SQLite database, you can get the last insert id by running the query:</p>

<blockquote>
<b>select last insert rowid</b>
</blockquote>


</body>
</html>
