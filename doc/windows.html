<html>
<head>
<title>firstworks   Using SQL Relay on Windows</title>
<link href="css/styles.css" rel="stylesheet">
</head>
<body>

<span class="heading1">Using SQL Relay on Windows</span><br><br>

<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#buildingnatively">Building SQL Relay Natively</a></li>
<li><a href="#buildingcygwin">Building SQL Relay Under Cygwin</a></li>
<li><a href="#server">Running the SQL Relay Server</a></li>
<li><a href="#cmdline">Using the Command Line Interfaces</a></li>
</ul>

<a name="introduction"></a>
<span class="heading2">Introduction</span><br><br>

<p>Support for SQL Relay on Windows has come a long way recently, mainly between release 0.45 and 0.46, but it still has a ways to go.</p>

<p>The SQL Relay client API's for C++, C, C# and ADO.NET and command line clients can be built using Visual Studio and run natively.  They are also available as binaries.</p>

<p>The SQL Relay server components and other API's must be built from source and run under Cygwin.  Many databases and languages are unsupported and I haven't done any performance benchmarking yet.</p>

<a name="buildingnatively"></a>
<span class="heading2">Building SQL Relay Natively</span><br><br>

<p>The native build process for SQL Relay is currently somewhat primitive.</p>

<p>If you are running Windows Vista or higher, as a non-Administrator users, you must first create the folder C:\Program Files\Firstworks and give yourself full access permissions.  This step is necessary if you are running as the Administrator or if you're running an older version of Windows.</p>

<p>Now, to build and install SQL Relay, download and extract the SQL Relay and Rudiments source distributions, then open the Visual Studio Command Prompt and navigate to the base directory that was created when Rudiments was extracted.</p>

<p>There should be a file named <i>make.batch</i> in that directory.  Rename this file to <i>make.bat</i>.  It is named with the .batch extension because various mail services don't allow .bat files to be emailed around, even if they are inside of an archive.  To get around this, the file must manually be renamed.  Now run: <i>make.bat</i></p>

<p>This should build and install Rudiments.  Various components will be installed under C:\Program Files\Firstworks.  If Rudiments is already installed there, the installation process will first remove it, then build it, then re-install it.</p>

<p>Assuming that was successful, still using the command line, navigate to the base directory that was created when SQL Relay was extracted.</p>

<p>Again, there should be a file named <i>make.batch</i> in that directory.  Rename this file to <i>make.bat</i> and run: <i>make.bat</i></p>

<p>This should build and install SQL Relay.  Various components will be installed under C:\Program Files\Firstworks.  If SQL Relay is already installed there, the installation process will first remove it, then build it, then re-install it.</p>

<p>To run the command line programs, it is helpful to add C:\Program Files\Firstworks\bin to your PATH but not strictly necessary.  Alternatively, you could just navigate to C:\Program Files\Firstworks\bin and run them from there.</p>

<p>If you need to uninstall everything, just trash the C:\Program Files\Firstworks folder.</p>

<a name="buildingcygwin"></a>
<span class="heading2">Building SQL Relay Under Cygwin</span><br><br>

<p>SQL Relay requires <a href="http://www.cygwin.com">Cygwin</a> to build and
run, so the first step in building SQL Relay is to
<a href="http://cygwin.com/cygwin-ug-net/setup-net.html">download and install Cygwin</a>.</p>

<p>I recommend doing a complete Cygwin installation to make sure you have all
of the components necessary to build and run SQL Relay.</p>

<p>Now, download, compile and install whatever languages or databases you need
SQL Relay to support.  Many languages and a few databases come with Cygwin.
Others have to be compiled from source and installed in the Cygwin environment.
Currently, SQL Relay cannot be compiled against non-Cygwin dll's, the resulting
binaries don't work, so you can't for instance, build against Oracle or Sybase,
or download the native Windows version of MySQL and build against it.</p>

<p>Now, download SQL Relay and follow the <a href="installing.html">standard
instructions</a> for building and installing it.  Use the Cygwin shell rather
than the Windows Command Line or DOS shell to build and install SQL Relay.</p>

<a name="server"></a>
<span class="heading2">Running the SQL Relay Server</span><br><br>

<p>SQL Relay makes extensive use of shared memory and semaphores.  The Cygwin
IPC server simulates these facilities on Windows.  Install the server as a
service and start it up following the instructions
<a href="http://cygwin.com/cygwin-ug-net/using-cygserver.html">here</a>.

<p>After installing the Cygwin IPC server, you need to add a CYGWIN environment
variable.  Use the System control panel to add an environment variable
called CYGWIN with the value <b>server</b>.</p>

<p>Once the IPC server is running, start up the database and follow the
<a href="running.html">standard instructions</a> for running SQL Relay.
Note that you will have to use <i>handoff="reconnect"</i> rather than
<i>handoff="pass"</i> in the sqlrelay.conf file.  <i>handoff="pass"</i> is
currently unsupported on Windows.  Also, make sure to execute the instructions
from within a Cygwin shell rather than from the Windows Command Line or DOS
shell.</p>

<p>NOTE: Do not ssh into your windows machine and run from SQL Relay from
that shell.  When logging in over ssh, the CYGWIN environment variable get's
overridden and doesn't contain <b>server</b>, preventing SQL Relay from using
the Cygwin IPC server.</p>

<p>Currently, there is no facility for installing SQL Relay as a service, so
it must be started and stopped manually from a Cygwin shell.</p>

<a name="cmdline"></a>
<span class="heading2">Using the Command Line Interfaces</span><br><br>

<p>Follow the <a href="running.html#cmdline">standard instructions</a> for running the command line interfaces.  If you built and/or installed the native software then you may use the Windows Command Line or DOS shell when running the SQL Relay command line interfaces.  If you built and installed using Cygwin then you must use the Cygwin command line instead.</p>

</body>
</html>
